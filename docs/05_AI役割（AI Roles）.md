# AI役割（AI Roles）

## 各AIの専門性と役割

本システムでは **Claude + Gemini + Perplexity** の3つのAIを使用します。
OpenAI APIは使用しません。

---

### Claude (Anthropic) - 統合・最終回答

#### 専門性
- 複雑な情報の統合
- 論理的な文章構成
- 品質保証
- 対話的な情報抽出

#### 得意なタスク
| タスク | 説明 |
|--------|------|
| 情報統合 | 複数ソースからの情報をまとめる |
| 構造化 | 回答を整理されたフォーマットに |
| 品質チェック | 矛盾や不足の検出 |
| 対話処理 | ユーザーとの対話から情報抽出 |

#### システムプロンプト
```
あなたはITサポートの統合エージェントです。

役割:
1. 収集された情報を統合
2. 情シス担当者向けに最適化
3. 回答の品質を保証

出力要件:
- 簡潔で実用的
- 手順は番号付き
- 注意点を明示
- 根拠を分離出力

出力形式（JSON）:
{
  "answer": "回答本文",
  "evidence": [{"source": "...", "url": "..."}],
  "sources": ["URL1", "URL2"],
  "confidence": 0.0-1.0
}
```

#### 使用モデル
- `claude-sonnet-4-20250514`

---

### Gemini - 情報収集・調査

#### 専門性
- 広範な技術情報収集
- トラブルシューティング
- 最新技術動向

#### 得意なタスク
| タスク | 説明 |
|--------|------|
| 技術調査 | 技術的な問題の調査 |
| 比較分析 | 複数の選択肢の比較 |
| 手順検索 | 設定手順・操作方法の検索 |
| 原因特定 | エラーや障害の原因調査 |

#### プロンプト例
```
以下のIT関連の質問について、技術的な情報を収集・整理してください。

質問: {user_query}

以下の形式で回答してください:
1. 問題の概要
2. 考えられる原因
3. 推奨される対処法
4. 関連する技術情報

日本語で回答してください。
```

#### 使用モデル
- `gemini-2.0-flash`

---

### Perplexity - 根拠生成・エビデンス収集

#### 専門性
- Web検索による根拠収集
- ソース明示
- 信頼性評価
- リアルタイム情報取得

#### 得意なタスク
| タスク | 説明 |
|--------|------|
| 根拠収集 | 回答の根拠となる情報収集 |
| ソース検証 | 情報源の信頼性確認 |
| URL取得 | 参照先URLの取得 |
| 最新情報 | リアルタイムのWeb情報取得 |

#### 出力形式
```json
{
  "evidence": [
    {
      "source": "Microsoft Docs",
      "url": "https://...",
      "snippet": "関連する記述...",
      "reliability": 0.95,
      "date": "2026-01-22"
    }
  ],
  "summary": "根拠の要約",
  "confidence": 0.88
}
```

#### 使用モデル
- `sonar`

---

## 役割分担マトリクス

| 質問タイプ | 主担当 | 副担当 | 統合 |
|------------|--------|--------|------|
| FAQ | Gemini | - | Claude |
| 技術調査 | Gemini | Perplexity | Claude |
| 障害対応 | Gemini | Perplexity | Claude |
| 根拠要求 | Perplexity | Gemini | Claude |
| 一般問い合わせ | Gemini | - | Claude |

## 処理フロー

```
1. クエリ分類: FAQ/Investigation/Evidence/General
   ↓
2. 並列処理: 担当AI実行
   ├─ Gemini: 技術情報収集
   └─ Perplexity: 根拠収集（必要時）
   ↓
3. Claude統合: 結果統合・最終回答生成
   ↓
4. 品質チェック: 最終確認
   ↓
5. 出力: 回答 + エビデンス（分離）
```

## コスト最適化

| AI | 用途 | 課金 | コスト感 |
|----|------|------|---------|
| Claude | 統合処理 | 従量 | 中 |
| Gemini | 情報収集 | 無料枠あり | 低 |
| Perplexity | 根拠収集 | 従量 | 中 |

**最適化戦略**:
- FAQは Gemini + Claude のみ（Perplexity不使用で高速化）
- Investigation/Evidence 時のみ Perplexity を使用
- キャッシュ活用で重複クエリを削減

## パフォーマンス指標

| 指標 | 目標 | 実績 |
|------|------|------|
| 平均応答時間 | 30秒以内 | 17-38秒 |
| 信頼度スコア | 80%以上 | 85-95% |
| エラー率 | 5%以下 | 検証中 |
