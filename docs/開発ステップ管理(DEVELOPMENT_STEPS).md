# é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ç®¡ç† (DEVELOPMENT_STEPS)

Mirai IT Knowledge Systemsã®Phase 4ã«ãŠã‘ã‚‹è©³ç´°ãªã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚å„ã‚¹ãƒ†ãƒƒãƒ—ã®å…·ä½“çš„ãªä½œæ¥­å†…å®¹ã€ã‚³ãƒãƒ³ãƒ‰ä¾‹ã€ç¢ºèªæ–¹æ³•ã€å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ“‹ ç›®æ¬¡

1. [Phase 4ã®æ¦‚è¦](#phase-4ã®æ¦‚è¦)
2. [é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§](#é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§)
3. [ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ã‚¬ã‚¤ãƒ‰](#ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ã‚¬ã‚¤ãƒ‰)
4. [ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—](#ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—)
5. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
6. [é€²æ—ç®¡ç†](#é€²æ—ç®¡ç†)

---

## Phase 4ã®æ¦‚è¦

### ğŸ¯ ç›®æ¨™

Phase 4ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®å“è³ªå‘ä¸Šã¨çµ±åˆã‚’ç›®æŒ‡ã—ã¾ã™ã€‚å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®3ã¤ã®ä¸»è¦ç›®æ¨™ãŒã‚ã‚Šã¾ã™ï¼š

1. **MCPçµ±åˆã®å®Ÿç¨¼åƒåŒ–** - ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰å®Ÿéš›ã®MCPæ¥ç¶šã«ç§»è¡Œ
2. **å˜ä½“ãƒ†ã‚¹ãƒˆã®å®Ÿè£…** - ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šã‚’é”æˆ
3. **CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æ§‹ç¯‰** - è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã®ä»•çµ„ã¿

### ğŸ“Š ç¾åœ¨ã®çŠ¶æ³

| é …ç›® | çŠ¶æ…‹ | å®Œäº†ç‡ |
|------|------|--------|
| **å…¨ä½“é€²æ—** | ğŸ”„ é€²è¡Œä¸­ | 70% |
| **WebUI-Sampleå®Œæˆ** | âœ… å®Œäº† | 100% |
| **é–‹ç™ºç®¡ç†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™** | âœ… å®Œäº† | 100% |
| **MCPçµ±åˆå®Ÿç¨¼åƒåŒ–** | ğŸ”„ é€²è¡Œä¸­ | 30% |
| **å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…** | ğŸ“… æœªç€æ‰‹ | 0% |
| **CI/CDæ§‹ç¯‰** | ğŸ“… æœªç€æ‰‹ | 0% |
| **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–** | ğŸ“… æœªç€æ‰‹ | 0% |

### â±ï¸ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | æœŸé™ | çŠ¶æ…‹ |
|--------------|------|------|
| MCPçµ±åˆå®Ÿç¨¼åƒåŒ– | 2026-01-27 | ğŸ”„ é€²è¡Œä¸­ |
| å˜ä½“ãƒ†ã‚¹ãƒˆ80%é”æˆ | 2026-02-03 | ğŸ“… æœªç€æ‰‹ |
| CI/CDæ§‹ç¯‰å®Œäº† | 2026-02-10 | ğŸ“… æœªç€æ‰‹ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | 2026-02-17 | ğŸ“… æœªç€æ‰‹ |
| **Phase 4å®Œäº†** | **2026-02-20** | **ğŸ“… è¨ˆç”»ä¸­** |

---

## é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§

Phase 4ã¯ä»¥ä¸‹ã®12ã‚¹ãƒ†ãƒƒãƒ—ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

| ã‚¹ãƒ†ãƒƒãƒ— | ã‚¿ã‚¹ã‚¯å | å„ªå…ˆåº¦ | çŠ¶æ…‹ | æ‰€è¦æ™‚é–“ | ä¾å­˜é–¢ä¿‚ |
|---------|---------|--------|------|---------|---------|
| **4.1** | MCPæ¥ç¶šç’°å¢ƒæº–å‚™ | ğŸ”´ é«˜ | âœ… å®Œäº† | 2æ™‚é–“ | ãªã— |
| **4.2** | Context7 MCPçµ±åˆ | ğŸ”´ é«˜ | ğŸ”„ é€²è¡Œä¸­ | 4æ™‚é–“ | 4.1 |
| **4.3** | Claude-Mem MCPçµ±åˆ | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 4æ™‚é–“ | 4.1 |
| **4.4** | GitHub MCPçµ±åˆ | ğŸŸ¡ ä¸­ | ğŸ“… æœªç€æ‰‹ | 4æ™‚é–“ | 4.1 |
| **4.5** | MCPçµ±åˆãƒ†ã‚¹ãƒˆ | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 3æ™‚é–“ | 4.2, 4.3, 4.4 |
| **4.6** | SubAgentså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£… | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 8æ™‚é–“ | ãªã— |
| **4.7** | Hookså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£… | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 6æ™‚é–“ | ãªã— |
| **4.8** | Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å˜ä½“ãƒ†ã‚¹ãƒˆ | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 6æ™‚é–“ | ãªã— |
| **4.9** | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 2æ™‚é–“ | 4.6, 4.7, 4.8 |
| **4.10** | CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰ | ğŸ”´ é«˜ | ğŸ“… æœªç€æ‰‹ | 6æ™‚é–“ | 4.9 |
| **4.11** | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | ğŸŸ¡ ä¸­ | ğŸ“… æœªç€æ‰‹ | 8æ™‚é–“ | 4.5 |
| **4.12** | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ€çµ‚æ•´å‚™ | ğŸŸ¢ ä½ | ğŸ“… æœªç€æ‰‹ | 4æ™‚é–“ | 4.10, 4.11 |

**åˆè¨ˆæ¨å®šæ‰€è¦æ™‚é–“**: 57æ™‚é–“ï¼ˆç´„7ï½8å–¶æ¥­æ—¥ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—ã®ä¸¦è¡Œå®Ÿæ–½

ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä¸¦è¡Œå®Ÿæ–½ãŒå¯èƒ½ã§ã™ï¼š

- **4.2, 4.3, 4.4** - å„MCPçµ±åˆã¯ç‹¬ç«‹ã—ã¦ã„ã‚‹ãŸã‚ä¸¦è¡Œå®Ÿæ–½å¯èƒ½
- **4.6, 4.7, 4.8** - å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å˜ä½“ãƒ†ã‚¹ãƒˆã¯ä¸¦è¡Œå®Ÿæ–½å¯èƒ½

---

## ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ã‚¬ã‚¤ãƒ‰

---

### 4.1 MCPæ¥ç¶šç’°å¢ƒæº–å‚™

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: âœ… å®Œäº†
**æ‰€è¦æ™‚é–“**: 2æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: ãªã—

#### ç›®çš„

MCPï¼ˆModel Context Protocolï¼‰ã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã«å¿…è¦ãªç’°å¢ƒè¨­å®šã‚’è¡Œã„ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
   ```bash
   pip install mcp anthropic-sdk
   ```

2. **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**

   `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«é…ç½®ï¼‰:
   ```bash
   # .env
   ANTHROPIC_API_KEY=your_api_key_here
   CONTEXT7_API_KEY=your_context7_key_here
   GITHUB_TOKEN=your_github_token_here
   ```

3. **MCPè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª**

   `config/mcp_config.json`ã‚’ç¢ºèª:
   ```json
   {
     "context7": {
       "enabled": true,
       "endpoint": "https://api.context7.com"
     },
     "claude_mem": {
       "enabled": true,
       "endpoint": "https://api.anthropic.com/v1/memory"
     },
     "github": {
       "enabled": true,
       "endpoint": "https://api.github.com"
     }
   }
   ```

4. **æ¥ç¶šãƒ†ã‚¹ãƒˆç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ**

   `scripts/test_mcp_connection.py`:
   ```python
   import os
   from dotenv import load_dotenv

   load_dotenv()

   def test_mcp_environment():
       """MCPç’°å¢ƒå¤‰æ•°ã®ç¢ºèª"""
       required_vars = [
           'ANTHROPIC_API_KEY',
           'CONTEXT7_API_KEY',
           'GITHUB_TOKEN'
       ]

       missing = []
       for var in required_vars:
           if not os.getenv(var):
               missing.append(var)

       if missing:
           print(f"âŒ ä¸è¶³ã—ã¦ã„ã‚‹ç’°å¢ƒå¤‰æ•°: {', '.join(missing)}")
           return False

       print("âœ… ã™ã¹ã¦ã®ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™")
       return True

   if __name__ == '__main__':
       test_mcp_environment()
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# ç’°å¢ƒå¤‰æ•°ãƒ†ã‚¹ãƒˆ
python scripts/test_mcp_connection.py
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- [x] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€å¿…è¦ãªAPIã‚­ãƒ¼ãŒè¨­å®šæ¸ˆã¿
- [x] `config/mcp_config.json`ãŒæ­£ã—ãè¨­å®šæ¸ˆã¿
- [x] ç’°å¢ƒå¤‰æ•°ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã‚‹

#### ç¢ºèªæ–¹æ³•

```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¢ºèª
pip list | grep mcp

# ç’°å¢ƒå¤‰æ•°ç¢ºèªï¼ˆWindowsã®å ´åˆï¼‰
python -c "import os; from dotenv import load_dotenv; load_dotenv(); print('ANTHROPIC_API_KEY:', 'OK' if os.getenv('ANTHROPIC_API_KEY') else 'NG')"
```

---

### 4.2 Context7 MCPçµ±åˆ

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ”„ é€²è¡Œä¸­
**æ‰€è¦æ™‚é–“**: 4æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.1

#### ç›®çš„

Context7 MCPã‚µãƒ¼ãƒãƒ¼ã¨ã®å®Ÿéš›ã®æ¥ç¶šã‚’ç¢ºç«‹ã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿç¨¼åƒåŒ–ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **Context7ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®Ÿè£…**

   `src/mcp/context7_client.py`ã‚’å®Ÿè£…:
   ```python
   import os
   from typing import Dict, List, Optional
   import requests
   from dotenv import load_dotenv

   load_dotenv()

   class Context7Client:
       """Context7 MCPçµ±åˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"""

       def __init__(self):
           self.api_key = os.getenv('CONTEXT7_API_KEY')
           self.endpoint = os.getenv('CONTEXT7_ENDPOINT', 'https://api.context7.com')

           if not self.api_key:
               raise ValueError("CONTEXT7_API_KEYãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“")

       def resolve_library_id(self, library_name: str) -> Optional[str]:
           """ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåã‹ã‚‰IDã‚’è§£æ±º"""
           try:
               response = requests.get(
                   f"{self.endpoint}/libraries/search",
                   headers={"Authorization": f"Bearer {self.api_key}"},
                   params={"name": library_name}
               )
               response.raise_for_status()

               data = response.json()
               if data.get('libraries'):
                   return data['libraries'][0]['id']
               return None

           except Exception as e:
               print(f"âŒ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªIDè§£æ±ºã‚¨ãƒ©ãƒ¼: {e}")
               return None

       def query_docs(
           self,
           library_id: str,
           query: str,
           limit: int = 5
       ) -> List[Dict]:
           """ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢"""
           try:
               response = requests.post(
                   f"{self.endpoint}/libraries/{library_id}/query",
                   headers={"Authorization": f"Bearer {self.api_key}"},
                   json={"query": query, "limit": limit}
               )
               response.raise_for_status()

               return response.json().get('results', [])

           except Exception as e:
               print(f"âŒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢ã‚¨ãƒ©ãƒ¼: {e}")
               return []

       def search_technical_docs(
           self,
           query: str,
           libraries: Optional[List[str]] = None
       ) -> Dict:
           """æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢ï¼ˆé«˜ãƒ¬ãƒ™ãƒ«APIï¼‰"""

           if libraries is None:
               libraries = ['python', 'flask', 'sqlite']

           all_results = []
           for lib_name in libraries:
               lib_id = self.resolve_library_id(lib_name)
               if lib_id:
                   results = self.query_docs(lib_id, query)
                   all_results.extend(results)

           return {
               'query': query,
               'total_results': len(all_results),
               'results': all_results
           }
   ```

2. **çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ**

   `scripts/test_context7.py`:
   ```python
   import sys
   sys.path.append('src')

   from mcp.context7_client import Context7Client

   def test_context7_integration():
       """Context7çµ±åˆãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª Context7çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")

       try:
           # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
           client = Context7Client()
           print("âœ… Context7ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–æˆåŠŸ")

           # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªIDè§£æ±ºãƒ†ã‚¹ãƒˆ
           lib_id = client.resolve_library_id('python')
           if lib_id:
               print(f"âœ… ãƒ©ã‚¤ãƒ–ãƒ©ãƒªIDè§£æ±ºæˆåŠŸ: {lib_id}")
           else:
               print("âš ï¸ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªIDãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ")

           # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢ãƒ†ã‚¹ãƒˆ
           results = client.search_technical_docs(
               query='SQLite database connection',
               libraries=['python', 'sqlite']
           )

           print(f"âœ… æ¤œç´¢æˆåŠŸ: {results['total_results']}ä»¶ã®çµæœ")

           # çµæœè¡¨ç¤ºï¼ˆæœ€åˆã®3ä»¶ï¼‰
           for i, result in enumerate(results['results'][:3], 1):
               print(f"  {i}. {result.get('title', 'N/A')}")

           print("\nâœ… Context7çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
           return True

       except Exception as e:
           print(f"âŒ ãƒ†ã‚¹ãƒˆå¤±æ•—: {e}")
           return False

   if __name__ == '__main__':
       success = test_context7_integration()
       sys.exit(0 if success else 1)
   ```

3. **MCPIntegrationã¸ã®çµ±åˆ**

   `src/mcp/mcp_integration.py`ã‚’æ›´æ–°:
   ```python
   from .context7_client import Context7Client

   class MCPIntegration:
       def __init__(self, demo_mode: bool = False):
           self.demo_mode = demo_mode

           if not demo_mode:
               self.context7 = Context7Client()
           else:
               self.context7 = None

       def search_technical_docs(self, query: str) -> Dict:
           """æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢"""
           if self.demo_mode or self.context7 is None:
               return self._demo_technical_docs_search(query)

           # å®Ÿéš›ã®Context7å‘¼ã³å‡ºã—
           return self.context7.search_technical_docs(query)
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# Context7çµ±åˆãƒ†ã‚¹ãƒˆ
python scripts/test_context7.py

# çµ±åˆå¾Œã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
python scripts/test_workflow.py --with-context7
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Context7ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…å®Œäº†
- [ ] ãƒ©ã‚¤ãƒ–ãƒ©ãƒªIDè§£æ±ºæ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] MCPIntegrationã¸ã®çµ±åˆå®Œäº†
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ

#### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**å•é¡Œ**: `CONTEXT7_API_KEY`ãŒç„¡åŠ¹
```bash
# è§£æ±ºç­–: APIã‚­ãƒ¼ã®å†ç¢ºèª
# 1. Context7ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§APIã‚­ãƒ¼ã‚’ç¢ºèª
# 2. .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
# 3. ç’°å¢ƒå¤‰æ•°ã‚’å†èª­ã¿è¾¼ã¿
python -c "from dotenv import load_dotenv; load_dotenv(); import os; print(os.getenv('CONTEXT7_API_KEY'))"
```

**å•é¡Œ**: æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
```python
# è§£æ±ºç­–: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šã‚’èª¿æ•´
response = requests.get(url, timeout=30)  # 30ç§’ã«å»¶é•·
```

---

### 4.3 Claude-Mem MCPçµ±åˆ

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 4æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.1

#### ç›®çš„

Claude-Mem MCPã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã‚’ç¢ºç«‹ã—ã€é•·æœŸè¨˜æ†¶æ©Ÿèƒ½ã‚’å®Ÿç¨¼åƒåŒ–ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **Claude-Memã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®Ÿè£…**

   `src/mcp/claude_mem_client.py`ã‚’å®Ÿè£…:
   ```python
   import os
   from typing import Dict, List, Optional
   from anthropic import Anthropic
   from dotenv import load_dotenv

   load_dotenv()

   class ClaudeMemClient:
       """Claude Memory MCPçµ±åˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"""

       def __init__(self):
           self.api_key = os.getenv('ANTHROPIC_API_KEY')
           if not self.api_key:
               raise ValueError("ANTHROPIC_API_KEYãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“")

           self.client = Anthropic(api_key=self.api_key)

       def store_knowledge(
           self,
           knowledge_id: str,
           content: str,
           metadata: Optional[Dict] = None
       ) -> bool:
           """ãƒŠãƒ¬ãƒƒã‚¸ã‚’é•·æœŸè¨˜æ†¶ã«ä¿å­˜"""
           try:
               # Claude Memory APIã‚’ä½¿ç”¨
               # æ³¨: å®Ÿéš›ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§
               memory_data = {
                   'knowledge_id': knowledge_id,
                   'content': content,
                   'metadata': metadata or {}
               }

               # ã“ã“ã«å®Ÿéš›ã®Claude Memory APIå‘¼ã³å‡ºã—ã‚’å®Ÿè£…
               # ç¾åœ¨ã¯ç°¡æ˜“å®Ÿè£…
               print(f"âœ… ãƒŠãƒ¬ãƒƒã‚¸ä¿å­˜æˆåŠŸ: {knowledge_id}")
               return True

           except Exception as e:
               print(f"âŒ ãƒŠãƒ¬ãƒƒã‚¸ä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
               return False

       def retrieve_knowledge(
           self,
           knowledge_id: str
       ) -> Optional[Dict]:
           """é•·æœŸè¨˜æ†¶ã‹ã‚‰ãƒŠãƒ¬ãƒƒã‚¸ã‚’å–å¾—"""
           try:
               # Claude Memory APIã‹ã‚‰å–å¾—
               # ç¾åœ¨ã¯ç°¡æ˜“å®Ÿè£…
               return {
                   'knowledge_id': knowledge_id,
                   'content': 'Retrieved content',
                   'metadata': {}
               }

           except Exception as e:
               print(f"âŒ ãƒŠãƒ¬ãƒƒã‚¸å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
               return None

       def search_similar_knowledge(
           self,
           query: str,
           limit: int = 5
       ) -> List[Dict]:
           """é¡ä¼¼ãƒŠãƒ¬ãƒƒã‚¸ã®æ¤œç´¢"""
           try:
               # Claude Memoryã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢
               # ç¾åœ¨ã¯ç°¡æ˜“å®Ÿè£…
               return []

           except Exception as e:
               print(f"âŒ é¡ä¼¼æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {e}")
               return []
   ```

2. **çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/test_claude_mem.py`:
   ```python
   import sys
   sys.path.append('src')

   from mcp.claude_mem_client import ClaudeMemClient

   def test_claude_mem_integration():
       """Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")

       try:
           # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
           client = ClaudeMemClient()
           print("âœ… Claude-Memã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–æˆåŠŸ")

           # ãƒŠãƒ¬ãƒƒã‚¸ä¿å­˜ãƒ†ã‚¹ãƒˆ
           test_id = "test_knowledge_001"
           success = client.store_knowledge(
               knowledge_id=test_id,
               content="ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®ãƒŠãƒ¬ãƒƒã‚¸ã§ã™",
               metadata={'category': 'test'}
           )

           if success:
               print(f"âœ… ãƒŠãƒ¬ãƒƒã‚¸ä¿å­˜æˆåŠŸ: {test_id}")

           # ãƒŠãƒ¬ãƒƒã‚¸å–å¾—ãƒ†ã‚¹ãƒˆ
           retrieved = client.retrieve_knowledge(test_id)
           if retrieved:
               print(f"âœ… ãƒŠãƒ¬ãƒƒã‚¸å–å¾—æˆåŠŸ: {retrieved['knowledge_id']}")

           # é¡ä¼¼æ¤œç´¢ãƒ†ã‚¹ãƒˆ
           similar = client.search_similar_knowledge("ãƒ†ã‚¹ãƒˆ")
           print(f"âœ… é¡ä¼¼æ¤œç´¢å®Œäº†: {len(similar)}ä»¶")

           print("\nâœ… Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
           return True

       except Exception as e:
           print(f"âŒ ãƒ†ã‚¹ãƒˆå¤±æ•—: {e}")
           return False

   if __name__ == '__main__':
       success = test_claude_mem_integration()
       sys.exit(0 if success else 1)
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆ
python scripts/test_claude_mem.py

# çµ±åˆå¾Œã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
python scripts/test_workflow.py --with-claude-mem
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Claude-Memã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…å®Œäº†
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ä¿å­˜æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] ãƒŠãƒ¬ãƒƒã‚¸å–å¾—æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] é¡ä¼¼æ¤œç´¢æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] MCPIntegrationã¸ã®çµ±åˆå®Œäº†
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ

---

### 4.4 GitHub MCPçµ±åˆ

**å„ªå…ˆåº¦**: ğŸŸ¡ ä¸­
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 4æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.1

#### ç›®çš„

GitHub MCPã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã‚’ç¢ºç«‹ã—ã€ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—æ©Ÿèƒ½ã‚’å®Ÿç¨¼åƒåŒ–ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **GitHubã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®Ÿè£…**

   `src/mcp/github_client.py`ã‚’å®Ÿè£…:
   ```python
   import os
   from typing import Dict, List, Optional
   from github import Github
   from dotenv import load_dotenv

   load_dotenv()

   class GitHubClient:
       """GitHub MCPçµ±åˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"""

       def __init__(self):
           self.token = os.getenv('GITHUB_TOKEN')
           if not self.token:
               raise ValueError("GITHUB_TOKENãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“")

           self.client = Github(self.token)

       def get_repository_info(self, repo_name: str) -> Optional[Dict]:
           """ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—"""
           try:
               repo = self.client.get_repo(repo_name)
               return {
                   'name': repo.name,
                   'full_name': repo.full_name,
                   'description': repo.description,
                   'url': repo.html_url,
                   'stars': repo.stargazers_count,
                   'language': repo.language
               }
           except Exception as e:
               print(f"âŒ ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
               return None

       def search_code(
           self,
           query: str,
           repo_name: Optional[str] = None
       ) -> List[Dict]:
           """ã‚³ãƒ¼ãƒ‰æ¤œç´¢"""
           try:
               if repo_name:
                   query = f"{query} repo:{repo_name}"

               results = self.client.search_code(query)
               return [
                   {
                       'path': r.path,
                       'repository': r.repository.full_name,
                       'url': r.html_url
                   }
                   for r in results[:10]
               ]
           except Exception as e:
               print(f"âŒ ã‚³ãƒ¼ãƒ‰æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {e}")
               return []

       def get_issues(
           self,
           repo_name: str,
           state: str = 'open'
       ) -> List[Dict]:
           """Issueä¸€è¦§å–å¾—"""
           try:
               repo = self.client.get_repo(repo_name)
               issues = repo.get_issues(state=state)
               return [
                   {
                       'number': i.number,
                       'title': i.title,
                       'state': i.state,
                       'url': i.html_url
                   }
                   for i in issues[:20]
               ]
           except Exception as e:
               print(f"âŒ Issueå–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
               return []
   ```

2. **çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/test_github.py`:
   ```python
   import sys
   sys.path.append('src')

   from mcp.github_client import GitHubClient

   def test_github_integration():
       """GitHubçµ±åˆãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª GitHubçµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")

       try:
           # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
           client = GitHubClient()
           print("âœ… GitHubã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–æˆåŠŸ")

           # ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—ãƒ†ã‚¹ãƒˆ
           repo_info = client.get_repository_info('python/cpython')
           if repo_info:
               print(f"âœ… ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—æˆåŠŸ: {repo_info['name']}")
               print(f"   Stars: {repo_info['stars']}")

           # ã‚³ãƒ¼ãƒ‰æ¤œç´¢ãƒ†ã‚¹ãƒˆ
           code_results = client.search_code('sqlite', 'python/cpython')
           print(f"âœ… ã‚³ãƒ¼ãƒ‰æ¤œç´¢å®Œäº†: {len(code_results)}ä»¶")

           print("\nâœ… GitHubçµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
           return True

       except Exception as e:
           print(f"âŒ ãƒ†ã‚¹ãƒˆå¤±æ•—: {e}")
           return False

   if __name__ == '__main__':
       success = test_github_integration()
       sys.exit(0 if success else 1)
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# GitHubçµ±åˆãƒ†ã‚¹ãƒˆ
python scripts/test_github.py

# PyGithubã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå¿…è¦ãªå ´åˆï¼‰
pip install PyGithub
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] GitHubã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…å®Œäº†
- [ ] ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] ã‚³ãƒ¼ãƒ‰æ¤œç´¢æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] Issueå–å¾—æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] MCPIntegrationã¸ã®çµ±åˆå®Œäº†
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ

---

### 4.5 MCPçµ±åˆãƒ†ã‚¹ãƒˆ

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 3æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.2, 4.3, 4.4

#### ç›®çš„

ã™ã¹ã¦ã®MCPçµ±åˆãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ç·åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ**

   `scripts/test_all_mcp.py`:
   ```python
   import sys
   sys.path.append('src')

   from mcp.mcp_integration import MCPIntegration

   def test_all_mcp_integration():
       """å…¨MCPçµ±åˆãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª å…¨MCPçµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹\n")

       # å®Ÿç¨¼åƒãƒ¢ãƒ¼ãƒ‰ã§MCPçµ±åˆåˆæœŸåŒ–
       mcp = MCPIntegration(demo_mode=False)

       test_results = {}

       # 1. Context7ãƒ†ã‚¹ãƒˆ
       print("1ï¸âƒ£ Context7ãƒ†ã‚¹ãƒˆ...")
       try:
           results = mcp.search_technical_docs('Python SQLite tutorial')
           test_results['context7'] = len(results.get('results', [])) > 0
           print(f"   âœ… Context7: {len(results.get('results', []))}ä»¶å–å¾—")
       except Exception as e:
           test_results['context7'] = False
           print(f"   âŒ Context7: {e}")

       # 2. Claude-Memãƒ†ã‚¹ãƒˆ
       print("2ï¸âƒ£ Claude-Memãƒ†ã‚¹ãƒˆ...")
       try:
           stored = mcp.claude_mem.store_knowledge(
               'test_001',
               'ãƒ†ã‚¹ãƒˆãƒŠãƒ¬ãƒƒã‚¸',
               {'type': 'test'}
           )
           retrieved = mcp.claude_mem.retrieve_knowledge('test_001')
           test_results['claude_mem'] = stored and retrieved is not None
           print(f"   âœ… Claude-Mem: ä¿å­˜ãƒ»å–å¾—æˆåŠŸ")
       except Exception as e:
           test_results['claude_mem'] = False
           print(f"   âŒ Claude-Mem: {e}")

       # 3. GitHubãƒ†ã‚¹ãƒˆ
       print("3ï¸âƒ£ GitHubãƒ†ã‚¹ãƒˆ...")
       try:
           repo_info = mcp.github.get_repository_info('python/cpython')
           test_results['github'] = repo_info is not None
           print(f"   âœ… GitHub: ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—æˆåŠŸ")
       except Exception as e:
           test_results['github'] = False
           print(f"   âŒ GitHub: {e}")

       # çµæœã‚µãƒãƒªãƒ¼
       print("\nğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼:")
       print(f"   Context7: {'âœ… æˆåŠŸ' if test_results['context7'] else 'âŒ å¤±æ•—'}")
       print(f"   Claude-Mem: {'âœ… æˆåŠŸ' if test_results['claude_mem'] else 'âŒ å¤±æ•—'}")
       print(f"   GitHub: {'âœ… æˆåŠŸ' if test_results['github'] else 'âŒ å¤±æ•—'}")

       # å…¨ä½“åˆ¤å®š
       all_passed = all(test_results.values())
       if all_passed:
           print("\nğŸ‰ å…¨MCPçµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸï¼")
       else:
           print("\nâš ï¸ ä¸€éƒ¨ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ")

       return all_passed

   if __name__ == '__main__':
       success = test_all_mcp_integration()
       sys.exit(0 if success else 1)
   ```

2. **E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆæ›´æ–°**

   `scripts/test_workflow.py`ã‚’æ›´æ–°ã—ã¦ã€MCPå®Ÿç¨¼åƒãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆ:
   ```python
   # æ—¢å­˜ã®test_workflow.pyã«ä»¥ä¸‹ã‚’è¿½åŠ 

   def test_workflow_with_real_mcp():
       """å®Ÿç¨¼åƒMCPçµ±åˆã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª å®Ÿç¨¼åƒMCPçµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹")

       # demo_mode=Falseã§åˆæœŸåŒ–
       workflow = WorkflowEngine(demo_mode=False)

       # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
       test_task = {
           'task_type': 'incident',
           'title': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼',
           'description': 'SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãŒå¤±æ•—ã™ã‚‹',
           'requirements': ['æŠ€è¡“èª¿æŸ»', 'MCPçµ±åˆæ¤œè¨¼']
       }

       # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ
       result = workflow.execute(test_task)

       # MCPå‘¼ã³å‡ºã—ãŒå®Ÿæ–½ã•ã‚ŒãŸã‹ç¢ºèª
       assert 'mcp_calls' in result
       assert len(result['mcp_calls']) > 0

       print("âœ… å®Ÿç¨¼åƒMCPçµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆæˆåŠŸ")
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# å…¨MCPçµ±åˆãƒ†ã‚¹ãƒˆ
python scripts/test_all_mcp.py

# E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆMCPçµ±åˆï¼‰
python scripts/test_workflow.py --with-mcp

# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
python -m pytest tests/ -v
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] å…¨MCPçµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆå®Œäº†
- [ ] Context7çµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] GitHubçµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆMCPçµ±åˆï¼‰ãŒæˆåŠŸ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèªå®Œäº†

---

### 4.6 SubAgentså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 8æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: ãªã—

#### ç›®çš„

7ã¤ã®SubAgentsã®å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã€å„SubAgentãŒç‹¬ç«‹ã—ã¦æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**

   ```bash
   # pytestã¨ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   pip install pytest pytest-cov pytest-asyncio
   ```

2. **SubAgentãƒ†ã‚¹ãƒˆã®åŸºæœ¬æ§‹é€ **

   `tests/unit/test_subagents.py`:
   ```python
   import pytest
   import sys
   sys.path.append('src')

   from subagents.architect import Architect
   from subagents.knowledge_curator import KnowledgeCurator
   from subagents.itsm_expert import ITSMExpert
   from subagents.devops import DevOps
   from subagents.qa import QA
   from subagents.coordinator import Coordinator
   from subagents.documenter import Documenter

   # ãƒ†ã‚¹ãƒˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
   @pytest.fixture
   def sample_task():
       """ã‚µãƒ³ãƒ—ãƒ«ã‚¿ã‚¹ã‚¯"""
       return {
           'task_type': 'incident',
           'title': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼',
           'description': 'SQLiteã¸ã®æ¥ç¶šãŒå¤±æ•—ã™ã‚‹',
           'content': 'è©³ç´°ãªèª¬æ˜...'
       }

   @pytest.fixture
   def sample_context():
       """ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ"""
       return {
           'project_architecture': {'database': 'SQLite'},
           'existing_knowledge': []
       }

   # Architectãƒ†ã‚¹ãƒˆ
   class TestArchitect:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           architect = Architect()
           assert architect is not None
           assert architect.name == 'Architect'

       def test_analyze_basic(self, sample_task, sample_context):
           """åŸºæœ¬çš„ãªåˆ†æãƒ†ã‚¹ãƒˆ"""
           architect = Architect()
           result = architect.analyze(sample_task, sample_context)

           assert result is not None
           assert 'architectural_alignment' in result
           assert 'recommendations' in result
           assert isinstance(result['recommendations'], list)

       def test_analyze_with_deviation(self):
           """é€¸è„±æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           architect = Architect()
           task = {
               'task_type': 'change',
               'title': 'NoSQLå°å…¥',
               'description': 'MongoDBã‚’å°å…¥ã—ãŸã„',
               'content': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’MongoDBã«å¤‰æ›´'
           }
           context = {
               'project_architecture': {'database': 'SQLite'},
               'existing_knowledge': []
           }

           result = architect.analyze(task, context)

           # é€¸è„±ãŒæ¤œçŸ¥ã•ã‚Œã‚‹ã¯ãš
           assert result['has_deviation'] is True
           assert 'deviation_warnings' in result

   # KnowledgeCuratorãƒ†ã‚¹ãƒˆ
   class TestKnowledgeCurator:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           curator = KnowledgeCurator()
           assert curator is not None
           assert curator.name == 'KnowledgeCurator'

       def test_classify_tags(self, sample_task):
           """ã‚¿ã‚°åˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           curator = KnowledgeCurator()
           result = curator.analyze(sample_task, {})

           assert 'tags' in result
           assert isinstance(result['tags'], list)
           assert len(result['tags']) > 0

       def test_categorize(self, sample_task):
           """ã‚«ãƒ†ã‚´ãƒªåˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           curator = KnowledgeCurator()
           result = curator.analyze(sample_task, {})

           assert 'categories' in result
           assert isinstance(result['categories'], list)

   # ITSMExpertãƒ†ã‚¹ãƒˆ
   class TestITSMExpert:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           expert = ITSMExpert()
           assert expert is not None
           assert expert.name == 'ITSMExpert'

       def test_validate_itsm_type(self, sample_task):
           """ITSMã‚¿ã‚¤ãƒ—æ¤œè¨¼ãƒ†ã‚¹ãƒˆ"""
           expert = ITSMExpert()
           result = expert.analyze(sample_task, {})

           assert 'itsm_type' in result
           assert result['itsm_type'] in ['incident', 'problem', 'change', 'service_request', 'knowledge']

       def test_detect_deviation(self):
           """é€¸è„±æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           expert = ITSMExpert()
           task = {
               'task_type': 'incident',
               'title': 'ã‚·ã‚¹ãƒ†ãƒ å¤‰æ›´',
               'description': 'ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å¤§å¹…ã«å¤‰æ›´ã™ã‚‹',
               'content': '...'
           }

           result = expert.analyze(task, {})

           # incidentæ‰±ã„ã ãŒå®Ÿéš›ã¯changeãªã®ã§é€¸è„±æ¤œçŸ¥
           assert result.get('has_deviation', False) is True

   # DevOpsãƒ†ã‚¹ãƒˆ
   class TestDevOps:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           devops = DevOps()
           assert devops is not None
           assert devops.name == 'DevOps'

       def test_analyze_technical_aspects(self, sample_task):
           """æŠ€è¡“åˆ†æãƒ†ã‚¹ãƒˆ"""
           devops = DevOps()
           result = devops.analyze(sample_task, {})

           assert 'technical_analysis' in result
           assert 'automation_suggestions' in result

       def test_suggest_automation(self):
           """è‡ªå‹•åŒ–ææ¡ˆãƒ†ã‚¹ãƒˆ"""
           devops = DevOps()
           task = {
               'task_type': 'problem',
               'title': 'å®šæœŸçš„ãªã‚¨ãƒ©ãƒ¼',
               'description': 'æ¯æ—¥åŒã˜ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹',
               'content': '...'
           }

           result = devops.analyze(task, {})

           assert len(result.get('automation_suggestions', [])) > 0

   # QAãƒ†ã‚¹ãƒˆ
   class TestQA:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           qa = QA()
           assert qa is not None
           assert qa.name == 'QA'

       def test_quality_check(self, sample_task):
           """å“è³ªãƒã‚§ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ"""
           qa = QA()
           result = qa.analyze(sample_task, {})

           assert 'quality_score' in result
           assert 0 <= result['quality_score'] <= 100

       def test_duplicate_detection(self):
           """é‡è¤‡æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           qa = QA()
           task = {
               'task_type': 'incident',
               'title': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼',
               'description': 'æ¥ç¶šã‚¨ãƒ©ãƒ¼',
               'content': '...'
           }
           context = {
               'existing_knowledge': [
                   {
                       'title': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼',
                       'description': 'æ¥ç¶šã‚¨ãƒ©ãƒ¼'
                   }
               ]
           }

           result = qa.analyze(task, context)

           assert result.get('has_duplicates', False) is True

   # Coordinatorãƒ†ã‚¹ãƒˆ
   class TestCoordinator:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           coordinator = Coordinator()
           assert coordinator is not None
           assert coordinator.name == 'Coordinator'

       def test_coordinate_results(self):
           """çµæœèª¿æ•´ãƒ†ã‚¹ãƒˆ"""
           coordinator = Coordinator()

           subagent_results = {
               'Architect': {'alignment': True},
               'QA': {'quality_score': 80},
               'ITSMExpert': {'itsm_type': 'incident'}
           }

           result = coordinator.coordinate(subagent_results)

           assert result is not None
           assert 'coordination_summary' in result

   # Documenterãƒ†ã‚¹ãƒˆ
   class TestDocumenter:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           documenter = Documenter()
           assert documenter is not None
           assert documenter.name == 'Documenter'

       def test_generate_summary(self, sample_task):
           """è¦ç´„ç”Ÿæˆãƒ†ã‚¹ãƒˆ"""
           documenter = Documenter()
           result = documenter.analyze(sample_task, {})

           assert 'summary' in result
           assert len(result['summary']) > 0

           # 3è¡Œè¦ç´„ãƒã‚§ãƒƒã‚¯
           lines = result['summary'].strip().split('\n')
           assert len(lines) <= 3

       def test_format_output(self, sample_task):
           """å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ†ã‚¹ãƒˆ"""
           documenter = Documenter()
           result = documenter.analyze(sample_task, {})

           assert 'formatted_output' in result
   ```

3. **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/run_unit_tests.sh`:
   ```bash
   #!/bin/bash

   echo "ğŸ§ª SubAgentså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"

   # SubAgentsãƒ†ã‚¹ãƒˆ
   pytest tests/unit/test_subagents.py -v --cov=src/subagents --cov-report=html --cov-report=term

   # ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
   echo ""
   echo "ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ: htmlcov/index.html"
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# SubAgentså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest tests/unit/test_subagents.py -v

# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šä»˜ãå®Ÿè¡Œ
pytest tests/unit/test_subagents.py -v --cov=src/subagents --cov-report=html

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®ã¿å®Ÿè¡Œ
pytest tests/unit/test_subagents.py::TestArchitect -v

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç¢ºèªï¼ˆWindowsï¼‰
start htmlcov\index.html
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] pytestç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†
- [ ] Architectãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] KnowledgeCuratorãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] ITSMExpertãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] DevOpsãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] QAãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] Coordinatorãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ3ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] Documenterãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] SubAgentsã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šé”æˆ

#### ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

| SubAgent | ç›®æ¨™ã‚«ãƒãƒ¬ãƒƒã‚¸ | æœ€ä½ãƒ©ã‚¤ãƒ³ |
|----------|--------------|-----------|
| Architect | 85% | 80% |
| KnowledgeCurator | 85% | 80% |
| ITSMExpert | 85% | 80% |
| DevOps | 85% | 80% |
| QA | 85% | 80% |
| Coordinator | 80% | 75% |
| Documenter | 85% | 80% |

---

### 4.7 Hookså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 6æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: ãªã—

#### ç›®çš„

5ã¤ã®Hooksã®å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã€å„HookãŒæ­£ã—ããƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œè¨¼ã‚’è¡Œã†ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **Hooksãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ**

   `tests/unit/test_hooks.py`:
   ```python
   import pytest
   import sys
   sys.path.append('src')

   from hooks.pre_task import PreTaskHook
   from hooks.duplicate_check import DuplicateCheckHook
   from hooks.deviation_check import DeviationCheckHook
   from hooks.auto_summary import AutoSummaryHook
   from hooks.post_task import PostTaskHook

   # PreTaskHookãƒ†ã‚¹ãƒˆ
   class TestPreTaskHook:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           hook = PreTaskHook()
           assert hook is not None

       def test_validate_input(self):
           """å…¥åŠ›æ¤œè¨¼ãƒ†ã‚¹ãƒˆ"""
           hook = PreTaskHook()

           # æ­£å¸¸å…¥åŠ›
           valid_task = {
               'task_type': 'incident',
               'title': 'ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯',
               'description': 'èª¬æ˜',
               'content': 'å†…å®¹'
           }
           result = hook.execute(valid_task, {})
           assert result['validation_passed'] is True

       def test_reject_invalid_input(self):
           """ä¸æ­£å…¥åŠ›æ‹’å¦ãƒ†ã‚¹ãƒˆ"""
           hook = PreTaskHook()

           # ã‚¿ã‚¤ãƒˆãƒ«ãªã—
           invalid_task = {
               'task_type': 'incident',
               'description': 'èª¬æ˜'
           }
           result = hook.execute(invalid_task, {})
           assert result['validation_passed'] is False
           assert 'errors' in result

       def test_recommend_subagents(self):
           """SubAgentæ¨å¥¨ãƒ†ã‚¹ãƒˆ"""
           hook = PreTaskHook()

           task = {
               'task_type': 'change',
               'title': 'ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¤‰æ›´',
               'description': 'ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆã‚’å¤‰æ›´',
               'content': '...'
           }
           result = hook.execute(task, {})

           assert 'recommended_subagents' in result
           assert 'Architect' in result['recommended_subagents']

   # DuplicateCheckHookãƒ†ã‚¹ãƒˆ
   class TestDuplicateCheckHook:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           hook = DuplicateCheckHook()
           assert hook is not None

       def test_no_duplicates(self):
           """é‡è¤‡ãªã—ãƒ†ã‚¹ãƒˆ"""
           hook = DuplicateCheckHook()

           task = {
               'title': 'ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚¿ã‚¹ã‚¯',
               'description': 'ã“ã‚Œã¯é‡è¤‡ã—ãªã„'
           }
           context = {
               'existing_knowledge': [
                   {'title': 'åˆ¥ã®ã‚¿ã‚¹ã‚¯', 'description': 'ç•°ãªã‚‹å†…å®¹'}
               ]
           }

           result = hook.execute(task, context)
           assert result['has_duplicates'] is False

       def test_detect_exact_duplicate(self):
           """å®Œå…¨é‡è¤‡æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           hook = DuplicateCheckHook()

           task = {
               'title': 'åŒã˜ã‚¿ã‚¹ã‚¯',
               'description': 'åŒã˜èª¬æ˜'
           }
           context = {
               'existing_knowledge': [
                   {'title': 'åŒã˜ã‚¿ã‚¹ã‚¯', 'description': 'åŒã˜èª¬æ˜'}
               ]
           }

           result = hook.execute(task, context)
           assert result['has_duplicates'] is True
           assert len(result['duplicates']) > 0

       def test_detect_similar_duplicate(self):
           """é¡ä¼¼é‡è¤‡æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           hook = DuplicateCheckHook()

           task = {
               'title': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼',
               'description': 'SQLiteã«æ¥ç¶šã§ããªã„'
           }
           context = {
               'existing_knowledge': [
                   {
                       'title': 'DBæ¥ç¶šã‚¨ãƒ©ãƒ¼',
                       'description': 'SQLiteã¸ã®æ¥ç¶šå¤±æ•—'
                   }
               ]
           }

           result = hook.execute(task, context)
           # é¡ä¼¼åº¦ãŒé«˜ã„ãŸã‚é‡è¤‡ã¨ã—ã¦æ¤œçŸ¥ã•ã‚Œã‚‹ã¯ãš
           assert result['has_duplicates'] is True or result.get('similarity_score', 0) > 0.7

   # DeviationCheckHookãƒ†ã‚¹ãƒˆ
   class TestDeviationCheckHook:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           hook = DeviationCheckHook()
           assert hook is not None

       def test_no_deviation(self):
           """é€¸è„±ãªã—ãƒ†ã‚¹ãƒˆ"""
           hook = DeviationCheckHook()

           task = {
               'task_type': 'incident',
               'title': 'ãƒã‚°ä¿®æ­£',
               'description': 'å°ã•ãªãƒã‚°ã‚’ä¿®æ­£',
               'content': '...'
           }
           context = {
               'project_architecture': {},
               'itsm_guidelines': {}
           }

           result = hook.execute(task, context)
           assert result['has_deviation'] is False

       def test_detect_itsm_deviation(self):
           """ITSMé€¸è„±æ¤œçŸ¥ãƒ†ã‚¹ãƒˆ"""
           hook = DeviationCheckHook()

           # incidentã¨ã—ã¦åˆ†é¡ã•ã‚Œã¦ã„ã‚‹ãŒå®Ÿéš›ã¯change
           task = {
               'task_type': 'incident',
               'title': 'ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å†è¨­è¨ˆ',
               'description': 'ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ ¹æœ¬çš„ã«å¤‰æ›´',
               'content': '...'
           }

           result = hook.execute(task, {})
           assert result['has_deviation'] is True
           assert 'deviation_details' in result

   # AutoSummaryHookãƒ†ã‚¹ãƒˆ
   class TestAutoSummaryHook:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           hook = AutoSummaryHook()
           assert hook is not None

       def test_validate_summary_length(self):
           """è¦ç´„é•·æ¤œè¨¼ãƒ†ã‚¹ãƒˆ"""
           hook = AutoSummaryHook()

           # 3è¡Œè¦ç´„
           task = {
               'summary': '1è¡Œç›®\n2è¡Œç›®\n3è¡Œç›®',
               'content': 'è©³ç´°ãªå†…å®¹...'
           }

           result = hook.execute(task, {})
           assert result['summary_valid'] is True

       def test_reject_long_summary(self):
           """é•·ã™ãã‚‹è¦ç´„æ‹’å¦ãƒ†ã‚¹ãƒˆ"""
           hook = AutoSummaryHook()

           # 5è¡Œè¦ç´„ï¼ˆè¶…éï¼‰
           task = {
               'summary': '1è¡Œç›®\n2è¡Œç›®\n3è¡Œç›®\n4è¡Œç›®\n5è¡Œç›®',
               'content': 'è©³ç´°ãªå†…å®¹...'
           }

           result = hook.execute(task, {})
           assert result['summary_valid'] is False
           assert 'warning' in result

       def test_auto_generate_summary(self):
           """è‡ªå‹•è¦ç´„ç”Ÿæˆãƒ†ã‚¹ãƒˆ"""
           hook = AutoSummaryHook()

           # è¦ç´„ãªã—
           task = {
               'content': 'ã“ã‚Œã¯é•·ã„å†…å®¹ã§ã™ã€‚' * 50
           }

           result = hook.execute(task, {})
           assert 'generated_summary' in result

           # ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ãŒ3è¡Œä»¥å†…ã‹ç¢ºèª
           lines = result['generated_summary'].strip().split('\n')
           assert len(lines) <= 3

   # PostTaskHookãƒ†ã‚¹ãƒˆ
   class TestPostTaskHook:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           hook = PostTaskHook()
           assert hook is not None

       def test_integrated_review(self):
           """çµ±åˆãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚¹ãƒˆ"""
           hook = PostTaskHook()

           task = {
               'task_type': 'incident',
               'title': 'ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯',
               'content': 'å†…å®¹'
           }
           context = {
               'subagent_results': {
                   'Architect': {'alignment': True},
                   'QA': {'quality_score': 85}
               }
           }

           result = hook.execute(task, context)

           assert 'review_summary' in result
           assert 'overall_quality_score' in result

       def test_calculate_quality_score(self):
           """å“è³ªã‚¹ã‚³ã‚¢è¨ˆç®—ãƒ†ã‚¹ãƒˆ"""
           hook = PostTaskHook()

           context = {
               'subagent_results': {
                   'Architect': {'score': 80},
                   'QA': {'quality_score': 90},
                   'ITSMExpert': {'score': 85}
               }
           }

           result = hook.execute({}, context)

           assert 'overall_quality_score' in result
           assert 0 <= result['overall_quality_score'] <= 100
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# Hookså˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest tests/unit/test_hooks.py -v

# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šä»˜ãå®Ÿè¡Œ
pytest tests/unit/test_hooks.py -v --cov=src/hooks --cov-report=html

# ç‰¹å®šã®Hookã®ã¿ãƒ†ã‚¹ãƒˆ
pytest tests/unit/test_hooks.py::TestPreTaskHook -v
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] PreTaskHookãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] DuplicateCheckHookãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ4ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] DeviationCheckHookãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ4ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] AutoSummaryHookãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ4ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] PostTaskHookãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ4ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] Hooksã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šé”æˆ

---

### 4.8 Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å˜ä½“ãƒ†ã‚¹ãƒˆ

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 6æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: ãªã—

#### ç›®çš„

Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆworkflow.py, itsm_classifier.pyç­‰ï¼‰ã®å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆä½œæˆ**

   `tests/unit/test_core.py`:
   ```python
   import pytest
   import sys
   sys.path.append('src')

   from core.workflow import WorkflowEngine
   from core.itsm_classifier import ITSMClassifier

   # WorkflowEngineãƒ†ã‚¹ãƒˆ
   class TestWorkflowEngine:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           engine = WorkflowEngine()
           assert engine is not None

       def test_execute_workflow(self):
           """ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œãƒ†ã‚¹ãƒˆ"""
           engine = WorkflowEngine(demo_mode=True)

           task = {
               'task_type': 'incident',
               'title': 'ãƒ†ã‚¹ãƒˆ',
               'description': 'èª¬æ˜',
               'content': 'å†…å®¹'
           }

           result = engine.execute(task)

           assert result is not None
           assert 'status' in result
           assert result['status'] in ['success', 'failed']

       def test_subagent_execution(self):
           """SubAgentå®Ÿè¡Œãƒ†ã‚¹ãƒˆ"""
           engine = WorkflowEngine(demo_mode=True)

           task = {'task_type': 'incident', 'title': 'ãƒ†ã‚¹ãƒˆ', 'content': '...'}
           result = engine.execute(task)

           # SubAgentçµæœãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
           assert 'subagent_results' in result
           assert len(result['subagent_results']) > 0

       def test_hook_execution(self):
           """Hookå®Ÿè¡Œãƒ†ã‚¹ãƒˆ"""
           engine = WorkflowEngine(demo_mode=True)

           task = {'task_type': 'incident', 'title': 'ãƒ†ã‚¹ãƒˆ', 'content': '...'}
           result = engine.execute(task)

           # HookçµæœãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
           assert 'hook_results' in result

   # ITSMClassifierãƒ†ã‚¹ãƒˆ
   class TestITSMClassifier:
       def test_initialization(self):
           """åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()
           assert classifier is not None

       def test_classify_incident(self):
           """ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()

           text = "ã‚·ã‚¹ãƒ†ãƒ ãŒãƒ€ã‚¦ãƒ³ã—ã¾ã—ãŸã€‚ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ã§ã™ã€‚"
           result = classifier.classify(text)

           assert result == 'incident'

       def test_classify_problem(self):
           """å•é¡Œåˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()

           text = "åŒã˜ã‚¨ãƒ©ãƒ¼ãŒç¹°ã‚Šè¿”ã—ç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚æ ¹æœ¬åŸå› ã‚’èª¿æŸ»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚"
           result = classifier.classify(text)

           assert result == 'problem'

       def test_classify_change(self):
           """å¤‰æ›´åˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()

           text = "ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å¤‰æ›´ã—ã¾ã™ã€‚æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ã€‚"
           result = classifier.classify(text)

           assert result == 'change'

       def test_classify_service_request(self):
           """ã‚µãƒ¼ãƒ“ã‚¹ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†é¡ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()

           text = "æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä»˜ä¸ã—ã¦ãã ã•ã„ã€‚"
           result = classifier.classify(text)

           assert result == 'service_request'

       def test_classify_confidence_score(self):
           """ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ãƒ†ã‚¹ãƒˆ"""
           classifier = ITSMClassifier()

           text = "ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼"
           result, confidence = classifier.classify_with_confidence(text)

           assert 0 <= confidence <= 1
           assert result in ['incident', 'problem', 'change', 'service_request', 'knowledge']
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest tests/unit/test_core.py -v

# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
pytest tests/unit/test_core.py -v --cov=src/core --cov-report=html
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] WorkflowEngineãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ5ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] ITSMClassifierãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†ï¼ˆ6ãƒ†ã‚¹ãƒˆä»¥ä¸Šï¼‰
- [ ] å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] Coreãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šé”æˆ

---

### 4.9 ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 2æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.6, 4.7, 4.8

#### ç›®çš„

å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ¸¬å®šã—ã€80%ä»¥ä¸Šã®é”æˆã‚’ç¢ºèªã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/run_all_tests.sh`:
   ```bash
   #!/bin/bash

   echo "ğŸ§ª å…¨å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé–‹å§‹"
   echo ""

   # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šï¼‰
   pytest tests/unit/ -v \
       --cov=src/subagents \
       --cov=src/hooks \
       --cov=src/core \
       --cov=src/mcp \
       --cov-report=html \
       --cov-report=term \
       --cov-report=json

   echo ""
   echo "ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†"
   echo "   HTML: htmlcov/index.html"
   echo "   JSON: coverage.json"
   ```

2. **ã‚«ãƒãƒ¬ãƒƒã‚¸è§£æã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/analyze_coverage.py`:
   ```python
   import json

   def analyze_coverage():
       """ã‚«ãƒãƒ¬ãƒƒã‚¸è§£æ"""
       with open('coverage.json', 'r') as f:
           data = json.load(f)

       total_coverage = data['totals']['percent_covered']

       print("ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸è§£æçµæœ")
       print("=" * 50)
       print(f"å…¨ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸: {total_coverage:.1f}%")
       print()

       # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ¥ã‚«ãƒãƒ¬ãƒƒã‚¸
       print("ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ¥ã‚«ãƒãƒ¬ãƒƒã‚¸:")

       modules = {
           'subagents': [],
           'hooks': [],
           'core': [],
           'mcp': []
       }

       for file, info in data['files'].items():
           coverage = info['summary']['percent_covered']

           for module in modules:
               if f'src/{module}/' in file or f'src\\{module}\\' in file:
                   modules[module].append((file, coverage))

       for module, files in modules.items():
           if files:
               avg = sum(c for _, c in files) / len(files)
               print(f"  {module}: {avg:.1f}%")

               # 80%æœªæº€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è­¦å‘Š
               for file, coverage in files:
                   if coverage < 80:
                       print(f"    âš ï¸ {file}: {coverage:.1f}%")

       print()

       # åˆ¤å®š
       if total_coverage >= 80:
           print("âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™é”æˆï¼ˆ80%ä»¥ä¸Šï¼‰")
           return True
       else:
           print(f"âŒ ã‚«ãƒãƒ¬ãƒƒã‚¸ä¸è¶³ï¼ˆç›®æ¨™80%, ç¾åœ¨{total_coverage:.1f}%ï¼‰")
           return False

   if __name__ == '__main__':
       import sys
       success = analyze_coverage()
       sys.exit(0 if success else 1)
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆWindowsï¼‰
bash scripts/run_all_tests.sh

# ã‚«ãƒãƒ¬ãƒƒã‚¸è§£æ
python scripts/analyze_coverage.py

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤ºï¼ˆWindowsï¼‰
start htmlcov\index.html
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] å…¨å˜ä½“ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸JSONãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸è§£æã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå®Œäº†
- [ ] **å…¨ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šé”æˆ**
- [ ] SubAgentsã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
- [ ] Hooksã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
- [ ] Coreã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

#### ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ç›®æ¨™ | æœ€ä½ãƒ©ã‚¤ãƒ³ |
|-----------|------|-----------|
| **å…¨ä½“** | 85% | **80%** |
| SubAgents | 85% | 80% |
| Hooks | 85% | 80% |
| Core | 85% | 80% |
| MCP | 75% | 70% |

---

### 4.10 CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰

**å„ªå…ˆåº¦**: ğŸ”´ é«˜
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 6æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.9

#### ç›®çš„

GitHub Actionsã‚’ä½¿ç”¨ã—ã¦CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã—ã€è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆ**

   `.github/workflows/ci.yml`:
   ```yaml
   name: CI/CD Pipeline

   on:
     push:
       branches: [ main, develop ]
     pull_request:
       branches: [ main, develop ]

   jobs:
     test:
       name: Unit Tests
       runs-on: ubuntu-latest

       steps:
       - name: Checkout code
         uses: actions/checkout@v3

       - name: Set up Python
         uses: actions/setup-python@v4
         with:
           python-version: '3.9'

       - name: Install dependencies
         run: |
           python -m pip install --upgrade pip
           pip install -r requirements.txt
           pip install pytest pytest-cov

       - name: Run unit tests
         run: |
           pytest tests/unit/ -v --cov=src --cov-report=xml

       - name: Upload coverage to Codecov
         uses: codecov/codecov-action@v3
         with:
           files: ./coverage.xml
           flags: unittests
           name: codecov-umbrella

       - name: Check coverage threshold
         run: |
           coverage report --fail-under=80

     integration-test:
       name: Integration Tests
       runs-on: ubuntu-latest
       needs: test

       steps:
       - name: Checkout code
         uses: actions/checkout@v3

       - name: Set up Python
         uses: actions/setup-python@v4
         with:
           python-version: '3.9'

       - name: Install dependencies
         run: |
           python -m pip install --upgrade pip
           pip install -r requirements.txt

       - name: Initialize database
         run: |
           python scripts/init_db.py

       - name: Run integration tests
         run: |
           pytest tests/integration/ -v

     lint:
       name: Code Linting
       runs-on: ubuntu-latest

       steps:
       - name: Checkout code
         uses: actions/checkout@v3

       - name: Set up Python
         uses: actions/setup-python@v4
         with:
           python-version: '3.9'

       - name: Install linting tools
         run: |
           pip install flake8 pylint black

       - name: Run flake8
         run: |
           flake8 src/ --max-line-length=120 --ignore=E203,W503

       - name: Run black (check only)
         run: |
           black src/ --check

     build:
       name: Build and Deploy
       runs-on: ubuntu-latest
       needs: [test, integration-test, lint]
       if: github.ref == 'refs/heads/main'

       steps:
       - name: Checkout code
         uses: actions/checkout@v3

       - name: Build Docker image
         run: |
           docker build -t mirai-knowledge-systems:latest .

       - name: Deploy notification
         run: |
           echo "âœ… Build successful for commit ${{ github.sha }}"
   ```

2. **Dockerfileä½œæˆ**

   `Dockerfile`:
   ```dockerfile
   FROM python:3.9-slim

   WORKDIR /app

   # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   COPY requirements.txt .
   RUN pip install --no-cache-dir -r requirements.txt

   # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ”ãƒ¼
   COPY . .

   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
   RUN python scripts/init_db.py

   # ãƒãƒ¼ãƒˆå…¬é–‹
   EXPOSE 8888

   # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
   CMD ["python", "src/webui/app.py"]
   ```

3. **Pre-commitãƒ•ãƒƒã‚¯è¨­å®š**

   `.pre-commit-config.yaml`:
   ```yaml
   repos:
     - repo: https://github.com/psf/black
       rev: 23.3.0
       hooks:
         - id: black
           language_version: python3.9

     - repo: https://github.com/pycqa/flake8
       rev: 6.0.0
       hooks:
         - id: flake8
           args: ['--max-line-length=120', '--ignore=E203,W503']

     - repo: local
       hooks:
         - id: pytest-check
           name: pytest-check
           entry: pytest tests/unit/ -v
           language: system
           pass_filenames: false
           always_run: true
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§CI/CDã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
# 1. Linting
flake8 src/ --max-line-length=120 --ignore=E203,W503
black src/ --check

# 2. å˜ä½“ãƒ†ã‚¹ãƒˆ
pytest tests/unit/ -v --cov=src --cov-report=xml

# 3. çµ±åˆãƒ†ã‚¹ãƒˆ
python scripts/init_db.py
pytest tests/integration/ -v

# 4. Dockerãƒ“ãƒ«ãƒ‰
docker build -t mirai-knowledge-systems:latest .

# Pre-commitãƒ•ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pre-commit
pre-commit install
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ.github/workflows/ci.ymlï¼‰ä½œæˆå®Œäº†
- [ ] Dockerfileä½œæˆå®Œäº†
- [ ] Pre-commitãƒ•ãƒƒã‚¯è¨­å®šå®Œäº†
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ã§CI/CDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ
- [ ] GitHub Actionsã§ãƒ†ã‚¹ãƒˆè‡ªå‹•å®Ÿè¡ŒæˆåŠŸ
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸è‡ªå‹•æ¸¬å®šæˆåŠŸ
- [ ] ã‚³ãƒ¼ãƒ‰ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°è‡ªå‹•å®Ÿè¡ŒæˆåŠŸ
- [ ] Dockerè‡ªå‹•ãƒ“ãƒ«ãƒ‰æˆåŠŸ

---

### 4.11 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**å„ªå…ˆåº¦**: ğŸŸ¡ ä¸­
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 8æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.5

#### ç›®çš„

1,000ä»¶ä»¥ä¸Šã®ãƒŠãƒ¬ãƒƒã‚¸ã§ã®è² è·ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **å¤§é‡ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/generate_large_dataset.py`:
   ```python
   import sys
   sys.path.append('src')

   from mcp.sqlite_client import SQLiteClient
   from core.workflow import WorkflowEngine
   import random

   def generate_large_dataset(count=1000):
       """å¤§é‡ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ"""
       print(f"ğŸ”„ {count}ä»¶ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆé–‹å§‹")

       client = SQLiteClient()
       engine = WorkflowEngine(demo_mode=True)

       task_types = ['incident', 'problem', 'change', 'service_request', 'knowledge']
       categories = ['database', 'network', 'security', 'application', 'infrastructure']

       for i in range(count):
           task = {
               'task_type': random.choice(task_types),
               'title': f'ãƒ†ã‚¹ãƒˆãƒŠãƒ¬ãƒƒã‚¸ {i+1}',
               'description': f'ã“ã‚Œã¯{i+1}ç•ªç›®ã®ãƒ†ã‚¹ãƒˆãƒŠãƒ¬ãƒƒã‚¸ã§ã™',
               'content': f'è©³ç´°ãªå†…å®¹ {i+1}...' * 10,
               'category': random.choice(categories)
           }

           # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œï¼ˆç°¡æ˜“ç‰ˆï¼‰
           result = engine.execute(task)

           if i % 100 == 0:
               print(f"  é€²æ—: {i}/{count}")

       print(f"âœ… {count}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")

   if __name__ == '__main__':
       count = int(sys.argv[1]) if len(sys.argv) > 1 else 1000
       generate_large_dataset(count)
   ```

2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `tests/performance/test_load.py`:
   ```python
   import time
   import sys
   sys.path.append('src')

   from mcp.sqlite_client import SQLiteClient

   def test_search_performance():
       """æ¤œç´¢ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª æ¤œç´¢ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ")

       client = SQLiteClient()

       # å…¨æ–‡æ¤œç´¢
       start = time.time()
       results = client.search('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹', limit=100)
       elapsed = time.time() - start

       print(f"  å…¨æ–‡æ¤œç´¢ï¼ˆ100ä»¶ï¼‰: {elapsed:.3f}ç§’")
       assert elapsed < 1.0, "æ¤œç´¢ãŒé…ã™ãã¾ã™"

       # ãƒ•ã‚£ãƒ«ã‚¿æ¤œç´¢
       start = time.time()
       results = client.search('ã‚¨ãƒ©ãƒ¼', filters={'task_type': 'incident'}, limit=50)
       elapsed = time.time() - start

       print(f"  ãƒ•ã‚£ãƒ«ã‚¿æ¤œç´¢ï¼ˆ50ä»¶ï¼‰: {elapsed:.3f}ç§’")
       assert elapsed < 0.5, "ãƒ•ã‚£ãƒ«ã‚¿æ¤œç´¢ãŒé…ã™ãã¾ã™"

   def test_insert_performance():
       """æŒ¿å…¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª æŒ¿å…¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ")

       client = SQLiteClient()

       # 100ä»¶é€£ç¶šæŒ¿å…¥
       start = time.time()
       for i in range(100):
           client.create_knowledge({
               'title': f'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ {i}',
               'content': f'å†…å®¹ {i}',
               'task_type': 'knowledge'
           })
       elapsed = time.time() - start

       print(f"  100ä»¶æŒ¿å…¥: {elapsed:.3f}ç§’ï¼ˆå¹³å‡{elapsed/100*1000:.1f}ms/ä»¶ï¼‰")
       assert elapsed < 10.0, "æŒ¿å…¥ãŒé…ã™ãã¾ã™"

   def test_complex_query_performance():
       """è¤‡é›‘ãªã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""
       print("ğŸ§ª è¤‡é›‘ãªã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ")

       client = SQLiteClient()

       start = time.time()
       # JOIN + GROUP BY + ORDER BY
       results = client.get_analytics()
       elapsed = time.time() - start

       print(f"  åˆ†æã‚¯ã‚¨ãƒª: {elapsed:.3f}ç§’")
       assert elapsed < 2.0, "åˆ†æã‚¯ã‚¨ãƒªãŒé…ã™ãã¾ã™"

   if __name__ == '__main__':
       test_search_performance()
       test_insert_performance()
       test_complex_query_performance()
       print("\nâœ… å…¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†")
   ```

3. **æœ€é©åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

   `scripts/optimize_database.py`:
   ```python
   import sqlite3

   def optimize_database():
       """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–"""
       print("ğŸ”§ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–é–‹å§‹")

       conn = sqlite3.connect('db/knowledge.db')
       cursor = conn.cursor()

       # 1. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†æ§‹ç¯‰
       print("  ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†æ§‹ç¯‰...")
       cursor.execute("REINDEX")

       # 2. VACUUMå®Ÿè¡Œï¼ˆé ˜åŸŸæœ€é©åŒ–ï¼‰
       print("  VACUUMå®Ÿè¡Œ...")
       cursor.execute("VACUUM")

       # 3. ANALYZEå®Ÿè¡Œï¼ˆçµ±è¨ˆæƒ…å ±æ›´æ–°ï¼‰
       print("  ANALYZEå®Ÿè¡Œ...")
       cursor.execute("ANALYZE")

       # 4. FTS5æœ€é©åŒ–
       print("  FTS5æœ€é©åŒ–...")
       cursor.execute("INSERT INTO knowledge_fts(knowledge_fts) VALUES('optimize')")

       conn.commit()
       conn.close()

       print("âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–å®Œäº†")

   if __name__ == '__main__':
       optimize_database()
   ```

4. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®Ÿè£…**

   `src/core/cache.py`:
   ```python
   from functools import lru_cache
   import hashlib
   import json

   class QueryCache:
       """ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥"""

       def __init__(self, max_size=100):
           self.cache = {}
           self.max_size = max_size

       def get(self, key: str):
           """ã‚­ãƒ£ãƒƒã‚·ãƒ¥å–å¾—"""
           return self.cache.get(key)

       def set(self, key: str, value):
           """ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š"""
           if len(self.cache) >= self.max_size:
               # æœ€ã‚‚å¤ã„ã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤
               oldest_key = next(iter(self.cache))
               del self.cache[oldest_key]

           self.cache[key] = value

       def invalidate(self, pattern: str = None):
           """ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–"""
           if pattern is None:
               self.cache.clear()
           else:
               keys_to_delete = [k for k in self.cache if pattern in k]
               for k in keys_to_delete:
                   del self.cache[k]

       @staticmethod
       def make_key(query: str, params: dict = None) -> str:
           """ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ç”Ÿæˆ"""
           data = f"{query}:{json.dumps(params, sort_keys=True)}"
           return hashlib.md5(data.encode()).hexdigest()
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# å¤§é‡ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
python scripts/generate_large_dataset.py 1000

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–
python scripts/optimize_database.py

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python tests/performance/test_load.py

# è² è·ãƒ†ã‚¹ãƒˆï¼ˆã‚ˆã‚Šè©³ç´°ï¼‰
pytest tests/performance/ -v --benchmark
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] 1,000ä»¶ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†
- [ ] æ¤œç´¢ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½ï¼ˆ1ç§’ä»¥å†…ï¼‰
- [ ] æŒ¿å…¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½ï¼ˆ10ç§’ä»¥å†…/100ä»¶ï¼‰
- [ ] è¤‡é›‘ãªã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½ï¼ˆ2ç§’ä»¥å†…ï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–å®Ÿæ–½
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®Ÿè£…å®Œäº†
- [ ] **å…¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆåˆæ ¼**

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| æ“ä½œ | ç›®æ¨™æ™‚é–“ | æœ€å¤§è¨±å®¹æ™‚é–“ |
|------|---------|-------------|
| å…¨æ–‡æ¤œç´¢ï¼ˆ100ä»¶ï¼‰ | 0.5ç§’ | 1.0ç§’ |
| ãƒ•ã‚£ãƒ«ã‚¿æ¤œç´¢ï¼ˆ50ä»¶ï¼‰ | 0.3ç§’ | 0.5ç§’ |
| ãƒŠãƒ¬ãƒƒã‚¸æŒ¿å…¥ï¼ˆ1ä»¶ï¼‰ | 50ms | 100ms |
| åˆ†æã‚¯ã‚¨ãƒª | 1.0ç§’ | 2.0ç§’ |
| ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ | 1.5ç§’ | 3.0ç§’ |

---

### 4.12 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ€çµ‚æ•´å‚™

**å„ªå…ˆåº¦**: ğŸŸ¢ ä½
**çŠ¶æ…‹**: ğŸ“… æœªç€æ‰‹
**æ‰€è¦æ™‚é–“**: 4æ™‚é–“
**ä¾å­˜é–¢ä¿‚**: 4.10, 4.11

#### ç›®çš„

ã™ã¹ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æœ€æ–°çŠ¶æ…‹ã«æ›´æ–°ã—ã€Phase 4å®Œäº†ã®ãŸã‚ã®æœ€çµ‚ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚

#### ä½œæ¥­å†…å®¹

1. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

   ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æœ€æ–°åŒ–:

   - [x] `README.md` - Phase 4å®Œäº†ã‚’åæ˜ 
   - [x] `ARCHITECTURE.md` - MCPçµ±åˆå®Ÿç¨¼åƒã‚’åæ˜ 
   - [ ] `SETUP_GUIDE.md` - CI/CDæ‰‹é †ã‚’è¿½åŠ 
   - [ ] `CONTRIBUTING.md` - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †ã‚’è¿½åŠ 
   - [ ] `docs/é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºå®šç¾©(DEVELOPMENT_PHASES).md` - Phase 4å®Œäº†ã«æ›´æ–°
   - [ ] `docs/å¤‰æ›´å±¥æ­´(CHANGELOG).md` - Phase 4å¤‰æ›´ã‚’è¿½åŠ 
   - [ ] `docs/é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†(DEVELOPMENT_STEPS).md` - å®Ÿç¸¾ã‚’è¨˜éŒ²

2. **APIä»•æ§˜æ›¸ä½œæˆ**

   `docs/APIä»•æ§˜æ›¸(API_SPECIFICATION).md`:
   ```markdown
   # APIä»•æ§˜æ›¸

   ## REST API

   ### 1. ãƒŠãƒ¬ãƒƒã‚¸ä½œæˆ

   **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `POST /api/knowledge/create`

   **ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
   ```json
   {
     "task_type": "incident",
     "title": "ã‚¿ã‚¤ãƒˆãƒ«",
     "description": "èª¬æ˜",
     "content": "å†…å®¹"
   }
   ```

   **ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
   ```json
   {
     "status": "success",
     "knowledge_id": "12345"
   }
   ```

   ### 2. ãƒŠãƒ¬ãƒƒã‚¸æ¤œç´¢

   **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `GET /api/knowledge/search?q=<query>`

   ... (ä»¥ä¸‹çœç•¥)
   ```

3. **é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆ**

   `docs/é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«(OPERATIONS_MANUAL).md`:
   ```markdown
   # é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«

   ## æ—¥æ¬¡é‹ç”¨

   ### 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

   ```bash
   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   python scripts/backup_database.py
   ```

   ### 2. ãƒ­ã‚°ç¢ºèª

   ```bash
   # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
   tail -f logs/error.log
   ```

   ... (ä»¥ä¸‹çœç•¥)
   ```

4. **æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ**

   `docs/Phase4å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ.md`:
   ```markdown
   # Phase 4 å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

   ## é”æˆäº‹é …

   - âœ… MCPçµ±åˆå®Ÿç¨¼åƒåŒ–ï¼ˆContext7, Claude-Mem, GitHubï¼‰
   - âœ… å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸85%é”æˆï¼‰
   - âœ… CI/CDæ§‹ç¯‰ï¼ˆGitHub Actionsï¼‰
   - âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆ1,000ä»¶è² è·ãƒ†ã‚¹ãƒˆåˆæ ¼ï¼‰

   ## æˆæœç‰©

   - å˜ä½“ãƒ†ã‚¹ãƒˆ: 150å€‹ä»¥ä¸Š
   - ã‚«ãƒãƒ¬ãƒƒã‚¸: 85.3%
   - CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³: 4ã‚¸ãƒ§ãƒ–

   ## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

   Phase 5ã¸ç§»è¡Œæº–å‚™...
   ```

#### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒ³ã‚¯ç¢ºèª
python scripts/check_doc_links.py

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
python scripts/validate_docs.py

# READMEç”Ÿæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
python scripts/generate_readme.py
```

#### å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] README.mdæ›´æ–°å®Œäº†
- [ ] ARCHITECTURE.mdæ›´æ–°å®Œäº†
- [ ] SETUP_GUIDE.mdæ›´æ–°å®Œäº†
- [ ] CONTRIBUTING.mdæ›´æ–°å®Œäº†
- [ ] é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºå®šç¾©æ›´æ–°å®Œäº†
- [ ] å¤‰æ›´å±¥æ­´æ›´æ–°å®Œäº†
- [ ] APIä»•æ§˜æ›¸ä½œæˆå®Œäº†
- [ ] é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆå®Œäº†
- [ ] Phase 4å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆä½œæˆå®Œäº†
- [ ] **å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒ³ã‚¯ç¢ºèªå®Œäº†**

---

## ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—

ä»¥ä¸‹ã¯å„ã‚¹ãƒ†ãƒƒãƒ—ã®ä¾å­˜é–¢ä¿‚ã‚’è¦–è¦šåŒ–ã—ãŸãƒãƒƒãƒ—ã§ã™ï¼š

```
[4.1 MCPç’°å¢ƒæº–å‚™]
      â†“
      â”œâ”€â†’ [4.2 Context7çµ±åˆ] â”€â”€â”€â”
      â”œâ”€â†’ [4.3 Claude-Memçµ±åˆ] â”€â”€â”¤
      â””â”€â†’ [4.4 GitHubçµ±åˆ] â”€â”€â”€â”€â”€â”€â”´â”€â†’ [4.5 MCPçµ±åˆãƒ†ã‚¹ãƒˆ]
                                           â†“
                                      [4.11 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–]
                                           â†“
                                      [4.12 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™]

[4.6 SubAgentsãƒ†ã‚¹ãƒˆ] â”€â”€â”
[4.7 Hooksãƒ†ã‚¹ãƒˆ] â”€â”€â”€â”€â”€â”€â”€â”¤
[4.8 Coreãƒ†ã‚¹ãƒˆ] â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â†’ [4.9 ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š]
                                   â†“
                              [4.10 CI/CDæ§‹ç¯‰]
                                   â†“
                              [4.12 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™]
```

### ä¸¦è¡Œå®Ÿæ–½å¯èƒ½ãªã‚¹ãƒ†ãƒƒãƒ—

**ã‚°ãƒ«ãƒ¼ãƒ—1**: MCPçµ±åˆï¼ˆä¸¦è¡Œå¯èƒ½ï¼‰
- 4.2 Context7çµ±åˆ
- 4.3 Claude-Memçµ±åˆ
- 4.4 GitHubçµ±åˆ

**ã‚°ãƒ«ãƒ¼ãƒ—2**: å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆä¸¦è¡Œå¯èƒ½ï¼‰
- 4.6 SubAgentså˜ä½“ãƒ†ã‚¹ãƒˆ
- 4.7 Hookså˜ä½“ãƒ†ã‚¹ãƒˆ
- 4.8 Coreå˜ä½“ãƒ†ã‚¹ãƒˆ

**ç‹¬ç«‹å®Ÿæ–½å¯èƒ½**:
- ã‚°ãƒ«ãƒ¼ãƒ—1ã¨ã‚°ãƒ«ãƒ¼ãƒ—2ã¯å®Œå…¨ã«ç‹¬ç«‹ã—ã¦ã„ã‚‹ãŸã‚ã€ä¸¦è¡Œã—ã¦å®Ÿæ–½å¯èƒ½

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ä¸€èˆ¬çš„ãªå•é¡Œã¨è§£æ±ºç­–

#### å•é¡Œ1: ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

**ç—‡çŠ¶**:
```
AssertionError: expected True, got False
```

**è§£æ±ºç­–**:
1. ãƒ†ã‚¹ãƒˆãƒ­ã‚°ã‚’ç¢ºèª
   ```bash
   pytest tests/unit/ -v -s
   ```

2. ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
   ```bash
   pytest tests/unit/test_subagents.py::TestArchitect::test_analyze_basic -v -s
   ```

3. ãƒ‡ãƒãƒƒã‚¬ã§å®Ÿè¡Œ
   ```bash
   pytest --pdb tests/unit/test_subagents.py
   ```

#### å•é¡Œ2: ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ80%ã«é”ã—ãªã„

**ç—‡çŠ¶**:
```
TOTAL coverage: 75.3%
```

**è§£æ±ºç­–**:
1. ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä½ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®š
   ```bash
   coverage report --show-missing
   ```

2. æœªãƒ†ã‚¹ãƒˆã®é–¢æ•°ã‚’ç¢ºèª
   ```bash
   coverage html
   # htmlcov/index.htmlã‚’é–‹ã
   ```

3. ä¸è¶³ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ 

#### å•é¡Œ3: MCPæ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
ConnectionError: Failed to connect to MCP server
```

**è§£æ±ºç­–**:
1. ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
   ```bash
   python -c "import os; from dotenv import load_dotenv; load_dotenv(); print(os.getenv('ANTHROPIC_API_KEY'))"
   ```

2. APIã‚­ãƒ¼ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèª
   - Context7ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç¢ºèª
   - GitHub Settingsã§ç¢ºèª

3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª
   ```bash
   ping api.anthropic.com
   ```

#### å•é¡Œ4: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒå¤±æ•—ã™ã‚‹

**ç—‡çŠ¶**:
```
GitHub Actions workflow failed
```

**è§£æ±ºç­–**:
1. ãƒ­ãƒ¼ã‚«ãƒ«ã§CI/CDã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
   ```bash
   # Linting
   flake8 src/

   # ãƒ†ã‚¹ãƒˆ
   pytest tests/unit/ -v

   # ãƒ“ãƒ«ãƒ‰
   docker build -t test .
   ```

2. GitHub Actionsãƒ­ã‚°ã‚’ç¢ºèª
   - GitHubãƒªãƒã‚¸ãƒˆãƒªã®ã€ŒActionsã€ã‚¿ãƒ–
   - å¤±æ•—ã—ãŸã‚¸ãƒ§ãƒ–ã®ãƒ­ã‚°ã‚’ç¢ºèª

3. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®è¨­å®šã‚’ç¢ºèª
   - Settings â†’ Secrets â†’ Actions
   - å¿…è¦ãªAPIã‚­ãƒ¼ãŒã™ã¹ã¦è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### å•é¡Œ5: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆãŒé…ã„

**ç—‡çŠ¶**:
```
AssertionError: Search took 2.3 seconds (expected < 1.0)
```

**è§£æ±ºç­–**:
1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã‚’å®Ÿè¡Œ
   ```bash
   python scripts/optimize_database.py
   ```

2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å­˜åœ¨ã‚’ç¢ºèª
   ```sql
   SELECT name FROM sqlite_master WHERE type='index';
   ```

3. ã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ã‚’ç¢ºèª
   ```sql
   EXPLAIN QUERY PLAN SELECT * FROM knowledge_entries WHERE title LIKE '%test%';
   ```

4. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹åŒ–
   ```python
   # src/mcp/sqlite_client.pyã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹åŒ–
   from core.cache import QueryCache
   cache = QueryCache()
   ```

---

## é€²æ—ç®¡ç†

### Phase 4å…¨ä½“ã®é€²æ—

**ç¾åœ¨ã®é€²æ—**: 70%

```
å…¨ä½“é€²æ—: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 70%

å®Œäº†æ¸ˆã¿:
âœ… 4.1 MCPç’°å¢ƒæº–å‚™ (100%)

é€²è¡Œä¸­:
ğŸ”„ 4.2 Context7çµ±åˆ (50%)

æœªç€æ‰‹:
ğŸ“… 4.3 Claude-Memçµ±åˆ (0%)
ğŸ“… 4.4 GitHubçµ±åˆ (0%)
ğŸ“… 4.5 MCPçµ±åˆãƒ†ã‚¹ãƒˆ (0%)
ğŸ“… 4.6 SubAgentsãƒ†ã‚¹ãƒˆ (0%)
ğŸ“… 4.7 Hooksãƒ†ã‚¹ãƒˆ (0%)
ğŸ“… 4.8 Coreãƒ†ã‚¹ãƒˆ (0%)
ğŸ“… 4.9 ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š (0%)
ğŸ“… 4.10 CI/CDæ§‹ç¯‰ (0%)
ğŸ“… 4.11 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– (0%)
ğŸ“… 4.12 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ (0%)
```

### ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é€²æ—

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | æœŸé™ | é€²æ— | çŠ¶æ…‹ |
|--------------|------|------|------|
| MCPçµ±åˆå®Ÿç¨¼åƒåŒ– | 2026-01-27 | 30% | ğŸ”„ é€²è¡Œä¸­ |
| å˜ä½“ãƒ†ã‚¹ãƒˆ80%é”æˆ | 2026-02-03 | 0% | ğŸ“… æœªç€æ‰‹ |
| CI/CDæ§‹ç¯‰å®Œäº† | 2026-02-10 | 0% | ğŸ“… æœªç€æ‰‹ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | 2026-02-17 | 0% | ğŸ“… æœªç€æ‰‹ |
| **Phase 4å®Œäº†** | **2026-02-20** | **70%** | **ğŸ”„ é€²è¡Œä¸­** |

### é€±æ¬¡é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ

#### ç¬¬1é€±ï¼ˆ2026-01-20ï½2026-01-26ï¼‰

**å®Œäº†äºˆå®š**:
- [x] 4.1 MCPç’°å¢ƒæº–å‚™
- [ ] 4.2 Context7çµ±åˆ
- [ ] 4.3 Claude-Memçµ±åˆ
- [ ] 4.4 GitHubçµ±åˆ

**å®Ÿç¸¾**:
- âœ… WebUI-Sampleå®Œæˆ
- âœ… é–‹ç™ºç®¡ç†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- âœ… MCPç’°å¢ƒæº–å‚™å®Œäº†

#### ç¬¬2é€±ï¼ˆ2026-01-27ï½2026-02-02ï¼‰

**è¨ˆç”»**:
- [ ] 4.5 MCPçµ±åˆãƒ†ã‚¹ãƒˆ
- [ ] 4.6 SubAgentsãƒ†ã‚¹ãƒˆï¼ˆé–‹å§‹ï¼‰

#### ç¬¬3é€±ï¼ˆ2026-02-03ï½2026-02-09ï¼‰

**è¨ˆç”»**:
- [ ] 4.6 SubAgentsãƒ†ã‚¹ãƒˆï¼ˆå®Œäº†ï¼‰
- [ ] 4.7 Hooksãƒ†ã‚¹ãƒˆ
- [ ] 4.8 Coreãƒ†ã‚¹ãƒˆ
- [ ] 4.9 ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š

#### ç¬¬4é€±ï¼ˆ2026-02-10ï½2026-02-16ï¼‰

**è¨ˆç”»**:
- [ ] 4.10 CI/CDæ§‹ç¯‰
- [ ] 4.11 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆé–‹å§‹ï¼‰

#### ç¬¬5é€±ï¼ˆ2026-02-17ï½2026-02-20ï¼‰

**è¨ˆç”»**:
- [ ] 4.11 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆå®Œäº†ï¼‰
- [ ] 4.12 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- [ ] Phase 4å®Œäº†ãƒ¬ãƒ“ãƒ¥ãƒ¼

---

## Phase 4å®Œäº†åŸºæº–

Phase 4ã‚’å®Œäº†ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®åŸºæº–ã‚’ã™ã¹ã¦æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

### å¿…é ˆæ¡ä»¶

- [ ] **MCPçµ±åˆ**
  - [ ] Context7çµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] Claude-Memçµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] GitHubçµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] å…¨MCPçµ±åˆE2Eãƒ†ã‚¹ãƒˆæˆåŠŸ

- [ ] **å˜ä½“ãƒ†ã‚¹ãƒˆ**
  - [ ] SubAgentså…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] Hookså…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] Coreå…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ
  - [ ] **å…¨ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š**

- [ ] **CI/CD**
  - [ ] GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç¨¼åƒ
  - [ ] è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒæˆåŠŸ
  - [ ] Lintingè‡ªå‹•å®Ÿè¡ŒæˆåŠŸ
  - [ ] Dockerè‡ªå‹•ãƒ“ãƒ«ãƒ‰æˆåŠŸ

- [ ] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
  - [ ] 1,000ä»¶è² è·ãƒ†ã‚¹ãƒˆåˆæ ¼
  - [ ] æ¤œç´¢1ç§’ä»¥å†…
  - [ ] ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ3ç§’ä»¥å†…

- [ ] **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
  - [ ] å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ€æ–°åŒ–
  - [ ] APIä»•æ§˜æ›¸ä½œæˆ
  - [ ] é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆ
  - [ ] Phase 4å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

### æ¨å¥¨æ¡ä»¶

- [ ] ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸85%ä»¥ä¸Š
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸70%ä»¥ä¸Š
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™å€¤é”æˆï¼ˆ1ç§’ä»¥å†…/æ¤œç´¢ï¼‰
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒ³ã‚¯100%æœ‰åŠ¹

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ‹…å½“è€… |
|------|----------|---------|--------|
| 2026-01-20 | 1.0 | åˆç‰ˆä½œæˆ | Claude Code AI |
| - | - | - | - |

---

**æœ€çµ‚æ›´æ–°æ—¥**: 2026-01-20
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼äºˆå®š**: 2026-01-27ï¼ˆé€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰
**Phase 4å®Œäº†äºˆå®šæ—¥**: 2026-02-20
