<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AIæ¤œç´¢ - Mirai IT Knowledge Systems">
    <title>AIæ¤œç´¢ - Mirai IT Knowledge Systems</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Header -->
    <header class="header" role="banner">
        <div class="container">
            <div class="header-content">
                <div>
                    <h1 class="header-title">Mirai IT Knowledge Systems</h1>
                    <p class="header-subtitle">ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªITãƒŠãƒ¬ãƒƒã‚¸ç®¡ç†</p>
                </div>
                <div class="header-actions">
                    <a href="create.html" class="btn" aria-label="æ–°è¦ä½œæˆ">
                        <span aria-hidden="true">âœï¸</span> æ–°è¦ä½œæˆ
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav" role="navigation" aria-label="ãƒ¡ã‚¤ãƒ³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³">
        <div class="container nav-container">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span aria-hidden="true">ğŸ </span> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
                    </a>
                </li>
                <li class="nav-item">
                    <a href="knowledge-list.html" class="nav-link">
                        <span aria-hidden="true">ğŸ“š</span> ãƒŠãƒ¬ãƒƒã‚¸ä¸€è¦§
                    </a>
                </li>
                <li class="nav-item">
                    <a href="create.html" class="nav-link">
                        <span aria-hidden="true">âœï¸</span> ä½œæˆ
                    </a>
                </li>
                <li class="nav-item">
                    <a href="search.html" class="nav-link">
                        <span aria-hidden="true">ğŸ”</span> ç¤¾å†…æ¤œç´¢
                    </a>
                </li>
                <li class="nav-item">
                    <a href="ai-search.html" class="nav-link active" aria-current="page">
                        <span aria-hidden="true">ğŸ§ </span> AIæ¤œç´¢
                    </a>
                </li>
                <li class="nav-item">
                    <a href="sf-browser.html" class="nav-link">
                        <span aria-hidden="true">ğŸ’¬</span> Server Fault
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main" role="main">
        <div class="container">
            <div class="search-section ai-search-view">
                <div class="search-header-bar">
                    <div class="search-header-content">
                        <div class="search-icon">ğŸ§ </div>
                        <div>
                            <h3 class="search-title">AIæ¤œç´¢ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h3>
                            <p class="search-subtitle">Claude â†’ Gemini â†’ Perplexity â†’ çµ±åˆ ã®4æ®µéšã§æœ€é©ãªå›ç­”ã‚’æä¾›ã—ã¾ã™</p>
                        </div>
                    </div>
                    <button class="reload-btn" id="reloadSearchBtn" title="æ¤œç´¢ã‚’ãƒªã‚»ãƒƒãƒˆ">
                        <span class="reload-icon">ğŸ”„</span>
                    </button>
                </div>

                <div class="search-container-wrapper">
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchInput" placeholder="ä¾‹: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒé…ã„æ™‚ã¯ã©ã†ã™ã‚Œã°ã„ã„ï¼Ÿ">
                        <button class="btn-search" id="btnSearch">
                            <span>æ¤œç´¢</span>
                        </button>
                    </div>

                    <div class="frequent-questions">
                        <div class="freq-label">ã‚ˆãä½¿ã†è³ªå•:</div>
                        <div class="freq-tags">
                            <button class="tag-btn">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒé…ã„æ™‚ã¯ï¼Ÿ</button>
                            <button class="tag-btn">503ã‚¨ãƒ©ãƒ¼ã®åŸå› ã¯ï¼Ÿ</button>
                            <button class="tag-btn">è¨¼æ˜æ›¸æ›´æ–°æ‰‹é †</button>
                            <button class="tag-btn">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š</button>
                        </div>
                    </div>

                    <!-- AIå‡¦ç†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
                    <div class="ai-processing" id="searchAiProcessing" style="display: none;">
                        <div class="processing-header">
                            <span class="processing-icon">âš¡</span>
                            <span>AIæ¤œç´¢å‡¦ç†ä¸­...</span>
                        </div>
                        <div class="ai-flow-icons" aria-hidden="true">
                            <span class="flow-icon" id="flow-claude" data-state="pending">â†’</span>
                            <span class="flow-icon" id="flow-gemini" data-state="pending">â†’</span>
                            <span class="flow-icon" id="flow-perplexity" data-state="pending">â†’</span>
                            <span class="flow-icon" id="flow-merge" data-state="pending">âœ…</span>
                        </div>
                        <div class="flow-status-row" aria-live="polite">
                            <div class="flow-status-item" id="flow-status-claude">
                                <span class="blink-dot" aria-hidden="true"></span>
                                <span>æ„å›³è§£æ / ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° / è¦ç´„</span>
                            </div>
                            <div class="flow-status-item" id="flow-status-gemini">
                                <span class="blink-dot" aria-hidden="true"></span>
                                <span>æŠ€è¡“æƒ…å ±æŠ½å‡º / å¤‰æ•°å€™è£œ</span>
                            </div>
                            <div class="flow-status-item" id="flow-status-perplexity">
                                <span class="blink-dot" aria-hidden="true"></span>
                                <span>æ ¹æ‹ åé›† / æœ€æ–°æƒ…å ±ã®è£œå¼·</span>
                            </div>
                            <div class="flow-status-item" id="flow-status-merge">
                                <span class="blink-dot" aria-hidden="true"></span>
                                <span>å›ç­”ç”Ÿæˆ / å‚ç…§ãƒªãƒ³ã‚¯æ•´ç†</span>
                            </div>
                        </div>
                        <div class="ai-pipeline">
                            <div class="pipeline-stage" id="searchStage1">
                                <div class="stage-icon">ğŸ§ </div>
                                <div class="stage-info">
                                    <span class="stage-name">Claude</span>
                                    <span class="stage-desc">æ„å›³è§£æ</span>
                                </div>
                                <div class="status-indicator waiting"></div>
                            </div>
                            <div class="pipeline-arrow">â†’</div>
                            <div class="pipeline-stage" id="searchStage2">
                                <div class="stage-icon">ğŸ”®</div>
                                <div class="stage-info">
                                    <span class="stage-name">Gemini</span>
                                    <span class="stage-desc">æŠ€è¡“æŠ½å‡º</span>
                                </div>
                                <div class="status-indicator waiting"></div>
                            </div>
                            <div class="pipeline-arrow">â†’</div>
                            <div class="pipeline-stage" id="searchStage3">
                                <div class="stage-icon">ğŸŒ</div>
                                <div class="stage-info">
                                    <span class="stage-name">Perplexity</span>
                                    <span class="stage-desc">æ ¹æ‹ è£œå¼·</span>
                                </div>
                                <div class="status-indicator waiting"></div>
                            </div>
                            <div class="pipeline-arrow">â†’</div>
                            <div class="pipeline-stage" id="searchStage4">
                                <div class="stage-icon">âœ…</div>
                                <div class="stage-info">
                                    <span class="stage-name">çµ±åˆ</span>
                                    <span class="stage-desc">å›ç­”ç”Ÿæˆ</span>
                                </div>
                                <div class="status-indicator waiting"></div>
                            </div>
                        </div>
                        <div class="processing-message" id="searchProcessingMessage">
                            <p>æ¤œç´¢æº–å‚™ä¸­...</p>
                        </div>
                    </div>

                    <div class="search-results hidden" id="searchResults">
                        <h4 class="results-title">æ¤œç´¢çµæœ</h4>
                        <div class="result-list" id="resultList"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Mirai IT Knowledge Systems</h4>
                    <p>AIã‚’æ´»ç”¨ã—ãŸã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªITãƒŠãƒ¬ãƒƒã‚¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
                </div>
                <div class="footer-section">
                    <h4>ãƒªãƒ³ã‚¯</h4>
                    <p><a href="index.html">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a></p>
                    <p><a href="knowledge-list.html">ãƒŠãƒ¬ãƒƒã‚¸ä¸€è¦§</a></p>
                    <p><a href="search.html">ç¤¾å†…æ¤œç´¢</a></p>
                    <p><a href="ai-search.html">AIæ¤œç´¢</a></p>
                </div>
                <div class="footer-section">
                    <h4>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h4>
                    <p><a href="README.md">ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</a></p>
                    <p><a href="#" aria-label="APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Mirai IT Knowledge Systems. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        const flowMap = {
            'stage-claude': 'flow-claude',
            'stage-gemini': 'flow-gemini',
            'stage-perplexity': 'flow-perplexity',
            'stage-merge': 'flow-merge'
        };

        const flowStatusMap = {
            'stage-claude': 'flow-status-claude',
            'stage-gemini': 'flow-status-gemini',
            'stage-perplexity': 'flow-status-perplexity',
            'stage-merge': 'flow-status-merge'
        };

        function setFlowState(stageId, state) {
            const flowId = flowMap[stageId];
            if (flowId) {
                const flowIcon = document.getElementById(flowId);
                if (flowIcon) {
                    flowIcon.setAttribute('data-state', state);
                }
            }
            const statusId = flowStatusMap[stageId];
            if (statusId) {
                const statusItem = document.getElementById(statusId);
                if (statusItem) {
                    if (state === 'processing') {
                        statusItem.classList.add('active');
                    } else {
                        statusItem.classList.remove('active');
                    }
                }
            }
        }

        function resetSearchProcessing() {
            const stageIds = ['searchStage1', 'searchStage2', 'searchStage3', 'searchStage4'];
            stageIds.forEach(id => {
                const stage = document.getElementById(id);
                if (stage) {
                    const indicator = stage.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator waiting';
                }
            });
            Object.keys(flowStatusMap).forEach(stageId => setFlowState(stageId, 'waiting'));
        }

        function showSearchProcessing() {
            const searchAiProcessing = document.getElementById('searchAiProcessing');
            if (!searchAiProcessing) return;

            searchAiProcessing.style.display = 'block';
            resetSearchProcessing();

            setTimeout(() => {
                const stage1 = document.getElementById('searchStage1');
                if (stage1) {
                    const indicator = stage1.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator processing';
                }
                setFlowState('stage-claude', 'processing');
                const msg = document.getElementById('searchProcessingMessage');
                if (msg) msg.innerHTML = '<p>Claude ãŒæ„å›³è§£æã¨è¦ç´„ã‚’ç”Ÿæˆä¸­...</p>';
            }, 300);

            setTimeout(() => {
                const stage1 = document.getElementById('searchStage1');
                if (stage1) {
                    const indicator = stage1.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator completed';
                }
                setFlowState('stage-claude', 'completed');
                const stage2 = document.getElementById('searchStage2');
                if (stage2) {
                    const indicator = stage2.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator processing';
                }
                setFlowState('stage-gemini', 'processing');
                const msg = document.getElementById('searchProcessingMessage');
                if (msg) msg.innerHTML = '<p>Gemini ãŒæŠ€è¡“æƒ…å ±ã‚’æŠ½å‡ºä¸­...</p>';
            }, 1500);

            setTimeout(() => {
                const stage2 = document.getElementById('searchStage2');
                if (stage2) {
                    const indicator = stage2.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator completed';
                }
                setFlowState('stage-gemini', 'completed');
                const stage3 = document.getElementById('searchStage3');
                if (stage3) {
                    const indicator = stage3.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator processing';
                }
                setFlowState('stage-perplexity', 'processing');
                const msg = document.getElementById('searchProcessingMessage');
                if (msg) msg.innerHTML = '<p>Perplexity ã§æœ€æ–°æƒ…å ±ã‚’è£œå®Œä¸­...</p>';
            }, 2600);

            setTimeout(() => {
                const stage3 = document.getElementById('searchStage3');
                if (stage3) {
                    const indicator = stage3.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator completed';
                }
                setFlowState('stage-perplexity', 'completed');
                const stage4 = document.getElementById('searchStage4');
                if (stage4) {
                    const indicator = stage4.querySelector('.status-indicator');
                    if (indicator) indicator.className = 'status-indicator processing';
                }
                setFlowState('stage-merge', 'processing');
                const msg = document.getElementById('searchProcessingMessage');
                if (msg) msg.innerHTML = '<p>çµ±åˆå›ç­”ã‚’ç”Ÿæˆä¸­...</p>';
            }, 3600);
        }

        function hideSearchProcessing() {
            const searchAiProcessing = document.getElementById('searchAiProcessing');
            if (!searchAiProcessing) return;

            const stage4 = document.getElementById('searchStage4');
            if (stage4) {
                const indicator = stage4.querySelector('.status-indicator');
                if (indicator) indicator.className = 'status-indicator completed';
            }
            setFlowState('stage-merge', 'completed');

            setTimeout(() => {
                searchAiProcessing.style.display = 'none';
                resetSearchProcessing();
            }, 600);
        }

        function renderResults() {
            const resultList = document.getElementById('resultList');
            if (!resultList) return;
            resultList.innerHTML = `
                <div style="padding: 20px; background: #f8fafc; border-radius: 10px; margin-bottom: 16px; border: 2px solid #e2e8f0;">
                    <h5 style="font-size: 16px; font-weight: 700; color: #6366f1; margin-bottom: 8px;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚¬ã‚¤ãƒ‰</h5>
                    <p style="font-size: 14px; color: #64748b; margin-bottom: 12px; line-height: 1.6;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒé…ã„æ™‚ã®è¨ºæ–­ã¨å¯¾å‡¦æ–¹æ³•ã‚’è©³ã—ãè§£èª¬ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æœ€é©åŒ–ã€ã‚¯ã‚¨ãƒªãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®šãªã©ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚</p>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <span style="padding: 4px 12px; background: #e0e7ff; border-radius: 12px; font-size: 12px; font-weight: 600; color: #4f46e5;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</span>
                        <span style="padding: 4px 12px; background: #dbeafe; border-radius: 12px; font-size: 12px; font-weight: 600; color: #1e40af;">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</span>
                    </div>
                </div>
                <div style="padding: 20px; background: #f8fafc; border-radius: 10px; margin-bottom: 16px; border: 2px solid #e2e8f0;">
                    <h5 style="font-size: 16px; font-weight: 700; color: #6366f1; margin-bottom: 8px;">PostgreSQL ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªå¯¾å¿œãƒãƒ‹ãƒ¥ã‚¢ãƒ«</h5>
                    <p style="font-size: 14px; color: #64748b; margin-bottom: 12px; line-height: 1.6;">ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªãƒ­ã‚°ã®ç¢ºèªæ–¹æ³•ã€EXPLAIN ANALYZEã®ä½¿ã„æ–¹ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’è§£èª¬ã€‚</p>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <span style="padding: 4px 12px; background: #e0e7ff; border-radius: 12px; font-size: 12px; font-weight: 600; color: #4f46e5;">PostgreSQL</span>
                        <span style="padding: 4px 12px; background: #dbeafe; border-radius: 12px; font-size: 12px; font-weight: 600; color: #1e40af;">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</span>
                    </div>
                </div>
                <div style="padding: 20px; background: #f8fafc; border-radius: 10px; border: 2px solid #e2e8f0;">
                    <h5 style="font-size: 16px; font-weight: 700; color: #6366f1; margin-bottom: 8px;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®šã‚¬ã‚¤ãƒ‰</h5>
                    <p style="font-size: 14px; color: #64748b; margin-bottom: 12px; line-height: 1.6;">pgBouncerã‚„HikariCPã®è¨­å®šæ–¹æ³•ã€æœ€é©ãªæ¥ç¶šãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚ºã®æ±ºå®šæ–¹æ³•ã€ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ‰‹æ³•ã‚’ç´¹ä»‹ã€‚</p>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <span style="padding: 4px 12px; background: #e0e7ff; border-radius: 12px; font-size: 12px; font-weight: 600; color: #4f46e5;">è¨­å®š</span>
                        <span style="padding: 4px 12px; background: #dbeafe; border-radius: 12px; font-size: 12px; font-weight: 600; color: #1e40af;">æ¥ç¶šãƒ—ãƒ¼ãƒ«</span>
                    </div>
                </div>
            `;
        }

        function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            if (!searchInput || !searchInput.value.trim()) return;

            if (searchResults) {
                searchResults.classList.add('hidden');
            }

            showSearchProcessing();

            setTimeout(() => {
                hideSearchProcessing();
                setTimeout(() => {
                    if (searchResults) {
                        searchResults.classList.remove('hidden');
                        renderResults();
                    }
                }, 300);
            }, 4200);
        }

        const btnSearch = document.getElementById('btnSearch');
        if (btnSearch) {
            btnSearch.addEventListener('click', performSearch);
        }

        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    performSearch();
                }
            });
        }

        document.querySelectorAll('.tag-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (searchInput) {
                    searchInput.value = btn.textContent;
                    performSearch();
                }
            });
        });

        const reloadSearchBtn = document.getElementById('reloadSearchBtn');
        if (reloadSearchBtn) {
            reloadSearchBtn.addEventListener('click', () => {
                if (searchInput) {
                    searchInput.value = '';
                }
                const searchResults = document.getElementById('searchResults');
                if (searchResults) {
                    searchResults.classList.add('hidden');
                }
                const searchAiProcessing = document.getElementById('searchAiProcessing');
                if (searchAiProcessing) {
                    searchAiProcessing.style.display = 'none';
                }
                resetSearchProcessing();
            });
        }
    </script>
</body>
</html>
